==========================================
Job ID: 2013127
Array Task ID: 2
Node: v100-f-11
Start Time: Thu Nov 13 11:09:15 AM AEDT 2025
==========================================
Activating conda environment...
Conda environment activated: LLMDTA
Checking GPU...
Thu Nov 13 11:09:16 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 565.57.01              Driver Version: 565.57.01      CUDA Version: 12.7     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-SXM2-32GB           On  |   00000000:3B:00.0 Off |                    0 |
| N/A   34C    P0             42W /  300W |       1MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Setting environment variables...

Starting training for fold 2...


============================================================
Starting training for Fold 2
Dataset: metz, Running Set: novel-pair
Epochs: 200, Batch Size: 16
============================================================

Executing: python -u code/train.py --fold 2 --cuda 0 --dataset metz --running_set novel-pair --epochs 200 --batch_size 16 --wandb_project LLMDTA
============================================================
Training Fold 2/4
Dataset: metz-novel-pair
Device: cuda (CUDA_VISIBLE_DEVICES=0)
Pretrain-./data/metz/metz_drug_pretrain.pkl
Pretrain-./data/metz/metz_esm_pretrain.pkl
============================================================
wandb: Currently logged in as: tringuyen to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: WARNING Using a boolean value for 'reinit' is deprecated. Use 'return_previous' or 'finish_previous' instead.
wandb: setting up run 9x5gi9bv
wandb: Tracking run with wandb version 0.23.0
wandb: Run data is saved locally in /vast/minhtrin/DTA/Temp/wandb/run-20251113_110922-9x5gi9bv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run metz-novel-pair-fold2
wandb: â­ï¸ View project at https://wandb.ai/tringuyen/LLMDTA
wandb: ğŸš€ View run at https://wandb.ai/tringuyen/LLMDTA/runs/9x5gi9bv
Weights & Biases initialized: LLMDTA
Loading fold 2 data...
  Train: ./data/dta-5fold-dataset/metz/novel-pair/fold_2_train.csv
  Valid: ./data/dta-5fold-dataset/metz/novel-pair/fold_2_valid.csv
  Test:  ./data/dta-5fold-dataset/metz/novel-pair/fold_2_test.csv
Dataset loaded: 13936 train, 16515 valid, 4808 test samples
/home/minhtrin/.conda/envs/LLMDTA/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:144: FutureWarning: `torch.nn.utils.weight_norm` is deprecated in favor of `torch.nn.utils.parametrizations.weight_norm`.
  WeightNorm.apply(module, name, dim)
Traing Log at fold-2 epoch-1: mse-2.682152, rmse-1.637728, r2--0.181033
Valid at fold-2: mse-1.87749
Update best_mse, Valid at fold-2 epoch-1: mse-1.87749, rmse-1.370215, ci--1, r2--1.044241, pearson-0.325058, spearman-0.308377
Traing Log at fold-2 epoch-2: mse-0.933376, rmse-0.966114, r2--0.175869
Valid at fold-2: mse-1.895259
Traing Log at fold-2 epoch-3: mse-0.731199, rmse-0.855101, r2--0.086021
Valid at fold-2: mse-1.549348
Update best_mse, Valid at fold-2 epoch-3: mse-1.549348, rmse-1.244728, ci--1, r2--0.686955, pearson-0.525742, spearman-0.490161
Traing Log at fold-2 epoch-4: mse-0.651888, rmse-0.807396, r2--0.006538
Valid at fold-2: mse-1.169284
Update best_mse, Valid at fold-2 epoch-4: mse-1.169284, rmse-1.081335, ci--1, r2--0.273136, pearson-0.535954, spearman-0.495626
Traing Log at fold-2 epoch-5: mse-0.590678, rmse-0.768556, r2-0.050461
Valid at fold-2: mse-0.898849
Update best_mse, Valid at fold-2 epoch-5: mse-0.898849, rmse-0.948076, ci--1, r2-0.021319, pearson-0.568588, spearman-0.520537
Traing Log at fold-2 epoch-6: mse-0.540516, rmse-0.735198, r2-0.100756
Valid at fold-2: mse-0.661993
Update best_mse, Valid at fold-2 epoch-6: mse-0.661993, rmse-0.81363, ci--1, r2-0.279211, pearson-0.61231, spearman-0.556585
Traing Log at fold-2 epoch-7: mse-0.502128, rmse-0.70861, r2-0.158035
Valid at fold-2: mse-0.663917
Traing Log at fold-2 epoch-8: mse-0.469174, rmse-0.684963, r2-0.190333
Valid at fold-2: mse-0.568142
Update best_mse, Valid at fold-2 epoch-8: mse-0.568142, rmse-0.753752, ci--1, r2-0.381398, pearson-0.632185, spearman-0.592082
Traing Log at fold-2 epoch-9: mse-0.442592, rmse-0.665276, r2-0.233103
Valid at fold-2: mse-0.526056
Update best_mse, Valid at fold-2 epoch-9: mse-0.526056, rmse-0.725297, ci--1, r2-0.427222, pearson-0.683411, spearman-0.636794
Traing Log at fold-2 epoch-10: mse-0.423189, rmse-0.65053, r2-0.265819
Valid at fold-2: mse-0.516729
Update best_mse, Valid at fold-2 epoch-10: mse-0.516729, rmse-0.718839, ci--1, r2-0.437377, pearson-0.668466, spearman-0.620148
Traing Log at fold-2 epoch-11: mse-0.394502, rmse-0.628094, r2-0.321854
Valid at fold-2: mse-0.49919
Update best_mse, Valid at fold-2 epoch-11: mse-0.49919, rmse-0.706534, ci--1, r2-0.456474, pearson-0.686049, spearman-0.636675
Traing Log at fold-2 epoch-12: mse-0.379781, rmse-0.616263, r2-0.357817
Valid at fold-2: mse-0.518562
Traing Log at fold-2 epoch-13: mse-0.368014, rmse-0.606642, r2-0.384993
Valid at fold-2: mse-0.481435
Update best_mse, Valid at fold-2 epoch-13: mse-0.481435, rmse-0.693855, ci--1, r2-0.475806, pearson-0.705399, spearman-0.657608
Traing Log at fold-2 epoch-14: mse-0.347569, rmse-0.58955, r2-0.430538
Valid at fold-2: mse-0.495235
Traing Log at fold-2 epoch-15: mse-0.339498, rmse-0.582664, r2-0.447924
Valid at fold-2: mse-0.472207
Update best_mse, Valid at fold-2 epoch-15: mse-0.472207, rmse-0.687173, ci--1, r2-0.485853, pearson-0.711947, spearman-0.664147
Traing Log at fold-2 epoch-16: mse-0.327482, rmse-0.572261, r2-0.475151
Valid at fold-2: mse-0.482867
Traing Log at fold-2 epoch-17: mse-0.314756, rmse-0.561031, r2-0.503317
Valid at fold-2: mse-0.467422
Update best_mse, Valid at fold-2 epoch-17: mse-0.467422, rmse-0.683683, ci--1, r2-0.491064, pearson-0.713523, spearman-0.663708
Traing Log at fold-2 epoch-18: mse-0.302262, rmse-0.549784, r2-0.533952
Valid at fold-2: mse-0.450638
Update best_mse, Valid at fold-2 epoch-18: mse-0.450638, rmse-0.671296, ci--1, r2-0.509338, pearson-0.720772, spearman-0.669371
Traing Log at fold-2 epoch-19: mse-0.292266, rmse-0.540616, r2-0.551435
Valid at fold-2: mse-0.449812
Update best_mse, Valid at fold-2 epoch-19: mse-0.449812, rmse-0.67068, ci--1, r2-0.510238, pearson-0.724185, spearman-0.677507
Traing Log at fold-2 epoch-20: mse-0.290462, rmse-0.538946, r2-0.556668
Valid at fold-2: mse-0.444965
Update best_mse, Valid at fold-2 epoch-20: mse-0.444965, rmse-0.667057, ci--1, r2-0.515515, pearson-0.725991, spearman-0.684076
Traing Log at fold-2 epoch-21: mse-0.279627, rmse-0.528798, r2-0.580446
Valid at fold-2: mse-0.435456
Update best_mse, Valid at fold-2 epoch-21: mse-0.435456, rmse-0.659891, ci--1, r2-0.525869, pearson-0.730116, spearman-0.685381
Traing Log at fold-2 epoch-22: mse-0.268692, rmse-0.518355, r2-0.601572
Valid at fold-2: mse-0.425576
Update best_mse, Valid at fold-2 epoch-22: mse-0.425576, rmse-0.652362, ci--1, r2-0.536626, pearson-0.739437, spearman-0.692854
Traing Log at fold-2 epoch-23: mse-0.265682, rmse-0.515444, r2-0.606996
Valid at fold-2: mse-0.42138
Update best_mse, Valid at fold-2 epoch-23: mse-0.42138, rmse-0.649138, ci--1, r2-0.541194, pearson-0.745904, spearman-0.703804
Traing Log at fold-2 epoch-24: mse-0.252719, rmse-0.502711, r2-0.632535
Valid at fold-2: mse-0.436601
Traing Log at fold-2 epoch-25: mse-0.248364, rmse-0.498361, r2-0.640763
Valid at fold-2: mse-0.429197
Traing Log at fold-2 epoch-26: mse-0.241492, rmse-0.491419, r2-0.655151
Valid at fold-2: mse-0.4165
Update best_mse, Valid at fold-2 epoch-26: mse-0.4165, rmse-0.645368, ci--1, r2-0.546508, pearson-0.746444, spearman-0.702382
Traing Log at fold-2 epoch-27: mse-0.234596, rmse-0.484351, r2-0.668705
Valid at fold-2: mse-0.413615
Update best_mse, Valid at fold-2 epoch-27: mse-0.413615, rmse-0.643129, ci--1, r2-0.549649, pearson-0.749771, spearman-0.70457
Traing Log at fold-2 epoch-28: mse-0.223986, rmse-0.473271, r2-0.687768
Valid at fold-2: mse-0.425852
Traing Log at fold-2 epoch-29: mse-0.224987, rmse-0.474328, r2-0.685741
Valid at fold-2: mse-0.429872
Traing Log at fold-2 epoch-30: mse-0.215699, rmse-0.464434, r2-0.701807
Valid at fold-2: mse-0.425238
Traing Log at fold-2 epoch-31: mse-0.2117, rmse-0.460109, r2-0.709975
Valid at fold-2: mse-0.414921
Traing Log at fold-2 epoch-32: mse-0.20391, rmse-0.451564, r2-0.722118
Valid at fold-2: mse-0.417872
Traing Log at fold-2 epoch-33: mse-0.202688, rmse-0.450209, r2-0.725471
Valid at fold-2: mse-0.415052
Traing Log at fold-2 epoch-34: mse-0.194503, rmse-0.441025, r2-0.739564
Valid at fold-2: mse-0.400654
Update best_mse, Valid at fold-2 epoch-34: mse-0.400654, rmse-0.632972, ci--1, r2-0.563762, pearson-0.757996, spearman-0.711313
Traing Log at fold-2 epoch-35: mse-0.189794, rmse-0.435653, r2-0.746642
Valid at fold-2: mse-0.41013
Traing Log at fold-2 epoch-36: mse-0.183724, rmse-0.42863, r2-0.756403
Valid at fold-2: mse-0.403374
Traing Log at fold-2 epoch-37: mse-0.181799, rmse-0.426379, r2-0.760007
Valid at fold-2: mse-0.427884
Traing Log at fold-2 epoch-38: mse-0.178388, rmse-0.42236, r2-0.766079
Valid at fold-2: mse-0.402523
Traing Log at fold-2 epoch-39: mse-0.173561, rmse-0.416606, r2-0.772637
Valid at fold-2: mse-0.401027
Traing Log at fold-2 epoch-40: mse-0.17358, rmse-0.416629, r2-0.774953
Valid at fold-2: mse-0.388581
Update best_mse, Valid at fold-2 epoch-40: mse-0.388581, rmse-0.623363, ci--1, r2-0.576906, pearson-0.768001, spearman-0.726821
Traing Log at fold-2 epoch-41: mse-0.16424, rmse-0.405266, r2-0.787644
Valid at fold-2: mse-0.388053
Update best_mse, Valid at fold-2 epoch-41: mse-0.388053, rmse-0.622939, ci--1, r2-0.577481, pearson-0.767101, spearman-0.725186
Traing Log at fold-2 epoch-42: mse-0.165315, rmse-0.406589, r2-0.786305
Valid at fold-2: mse-0.397086
Traing Log at fold-2 epoch-43: mse-0.160108, rmse-0.400135, r2-0.79404
Valid at fold-2: mse-0.388077
Traing Log at fold-2 epoch-44: mse-0.156305, rmse-0.395354, r2-0.799872
Valid at fold-2: mse-0.4028
Traing Log at fold-2 epoch-45: mse-0.154131, rmse-0.392595, r2-0.804118
Valid at fold-2: mse-0.389647
Traing Log at fold-2 epoch-46: mse-0.151186, rmse-0.388826, r2-0.807667
Valid at fold-2: mse-0.398825
Traing Log at fold-2 epoch-47: mse-0.149481, rmse-0.386628, r2-0.811395
Valid at fold-2: mse-0.399519
Traing Log at fold-2 epoch-48: mse-0.145221, rmse-0.381079, r2-0.817551
Valid at fold-2: mse-0.384518
Update best_mse, Valid at fold-2 epoch-48: mse-0.384518, rmse-0.620095, ci--1, r2-0.58133, pearson-0.768874, spearman-0.730132
Traing Log at fold-2 epoch-49: mse-0.144288, rmse-0.379853, r2-0.818401
Valid at fold-2: mse-0.395101
Traing Log at fold-2 epoch-50: mse-0.137806, rmse-0.371222, r2-0.828022
Valid at fold-2: mse-0.399764
Traing Log at fold-2 epoch-51: mse-0.135035, rmse-0.367472, r2-0.832238
Valid at fold-2: mse-0.393108
Traing Log at fold-2 epoch-52: mse-0.134511, rmse-0.366758, r2-0.832823
Valid at fold-2: mse-0.380729
Update best_mse, Valid at fold-2 epoch-52: mse-0.380729, rmse-0.617032, ci--1, r2-0.585456, pearson-0.772038, spearman-0.732296
Traing Log at fold-2 epoch-53: mse-0.132348, rmse-0.363796, r2-0.836156
Valid at fold-2: mse-0.397444
Traing Log at fold-2 epoch-54: mse-0.126107, rmse-0.355115, r2-0.844685
Valid at fold-2: mse-0.397262
Traing Log at fold-2 epoch-55: mse-0.1292, rmse-0.359444, r2-0.840329
Valid at fold-2: mse-0.387825
Traing Log at fold-2 epoch-56: mse-0.122926, rmse-0.350608, r2-0.849539
Valid at fold-2: mse-0.382902
Traing Log at fold-2 epoch-57: mse-0.122519, rmse-0.350027, r2-0.849808
Valid at fold-2: mse-0.39589
Traing Log at fold-2 epoch-58: mse-0.119451, rmse-0.345616, r2-0.854194
Valid at fold-2: mse-0.384513
Traing Log at fold-2 epoch-59: mse-0.117428, rmse-0.342677, r2-0.857198
Valid at fold-2: mse-0.404801
Traing Log at fold-2 epoch-60: mse-0.118342, rmse-0.344009, r2-0.856081
Valid at fold-2: mse-0.404738
Traing Log at fold-2 epoch-61: mse-0.113867, rmse-0.337442, r2-0.861883
Valid at fold-2: mse-0.385631
Traing Log at fold-2 epoch-62: mse-0.113745, rmse-0.337261, r2-0.862824
Valid at fold-2: mse-0.394484
Traing Log at fold-2 epoch-63: mse-0.112911, rmse-0.336023, r2-0.863446
Valid at fold-2: mse-0.393607
Traing Log at fold-2 epoch-64: mse-0.110405, rmse-0.332273, r2-0.866599
Valid at fold-2: mse-0.3909
Traing Log at fold-2 epoch-65: mse-0.110617, rmse-0.332592, r2-0.866917
Valid at fold-2: mse-0.390903
Traing Log at fold-2 epoch-66: mse-0.105696, rmse-0.325109, r2-0.873284
Valid at fold-2: mse-0.383645
Traing Log at fold-2 epoch-67: mse-0.105162, rmse-0.324287, r2-0.874002
Valid at fold-2: mse-0.393559
Traing Log at fold-2 epoch-68: mse-0.105573, rmse-0.324921, r2-0.873863
Valid at fold-2: mse-0.383829
Traing Log at fold-2 epoch-69: mse-0.101407, rmse-0.318445, r2-0.879283
Valid at fold-2: mse-0.38329
Traing Log at fold-2 epoch-70: mse-0.100392, rmse-0.316847, r2-0.880253
Valid at fold-2: mse-0.37795
Update best_mse, Valid at fold-2 epoch-70: mse-0.37795, rmse-0.614777, ci--1, r2-0.588482, pearson-0.779964, spearman-0.741273
Traing Log at fold-2 epoch-71: mse-0.099003, rmse-0.314648, r2-0.88218
Valid at fold-2: mse-0.372549
Update best_mse, Valid at fold-2 epoch-71: mse-0.372549, rmse-0.610368, ci--1, r2-0.594362, pearson-0.780534, spearman-0.740941
Traing Log at fold-2 epoch-72: mse-0.097129, rmse-0.311656, r2-0.885077
Valid at fold-2: mse-0.376855
Traing Log at fold-2 epoch-73: mse-0.097716, rmse-0.312596, r2-0.883876
Valid at fold-2: mse-0.370276
Update best_mse, Valid at fold-2 epoch-73: mse-0.370276, rmse-0.608503, ci--1, r2-0.596837, pearson-0.782047, spearman-0.742401
Traing Log at fold-2 epoch-74: mse-0.096958, rmse-0.311381, r2-0.885128
Valid at fold-2: mse-0.379176
Traing Log at fold-2 epoch-75: mse-0.096002, rmse-0.309842, r2-0.886369
Valid at fold-2: mse-0.381817
Traing Log at fold-2 epoch-76: mse-0.094867, rmse-0.308005, r2-0.887759
Valid at fold-2: mse-0.385803
Traing Log at fold-2 epoch-77: mse-0.093812, rmse-0.306287, r2-0.889264
Valid at fold-2: mse-0.365641
Update best_mse, Valid at fold-2 epoch-77: mse-0.365641, rmse-0.604683, ci--1, r2-0.601884, pearson-0.786138, spearman-0.746764
Traing Log at fold-2 epoch-78: mse-0.08986, rmse-0.299767, r2-0.894463
Valid at fold-2: mse-0.387824
Traing Log at fold-2 epoch-79: mse-0.088718, rmse-0.297855, r2-0.895751
Valid at fold-2: mse-0.371719
Traing Log at fold-2 epoch-80: mse-0.086533, rmse-0.294165, r2-0.898625
Valid at fold-2: mse-0.384658
Traing Log at fold-2 epoch-81: mse-0.089669, rmse-0.299448, r2-0.894518
Valid at fold-2: mse-0.378375
Traing Log at fold-2 epoch-82: mse-0.087397, rmse-0.29563, r2-0.897387
Valid at fold-2: mse-0.375318
Traing Log at fold-2 epoch-83: mse-0.083436, rmse-0.288853, r2-0.902818
Valid at fold-2: mse-0.375499
Traing Log at fold-2 epoch-84: mse-0.086191, rmse-0.293584, r2-0.899106
Valid at fold-2: mse-0.381111
Traing Log at fold-2 epoch-85: mse-0.084699, rmse-0.291032, r2-0.901108
Valid at fold-2: mse-0.385623
Traing Log at fold-2 epoch-86: mse-0.08353, rmse-0.289016, r2-0.902456
Valid at fold-2: mse-0.365596
Update best_mse, Valid at fold-2 epoch-86: mse-0.365596, rmse-0.604645, ci--1, r2-0.601933, pearson-0.784553, spearman-0.74609
Traing Log at fold-2 epoch-87: mse-0.082176, rmse-0.286664, r2-0.904327
Valid at fold-2: mse-0.378146
Traing Log at fold-2 epoch-88: mse-0.083147, rmse-0.288353, r2-0.903335
Valid at fold-2: mse-0.374608
Traing Log at fold-2 epoch-89: mse-0.078788, rmse-0.280693, r2-0.908426
Valid at fold-2: mse-0.373253
Traing Log at fold-2 epoch-90: mse-0.079361, rmse-0.28171, r2-0.907853
Valid at fold-2: mse-0.374021
Traing Log at fold-2 epoch-91: mse-0.079758, rmse-0.282414, r2-0.907401
Valid at fold-2: mse-0.382002
Traing Log at fold-2 epoch-92: mse-0.080441, rmse-0.283622, r2-0.906475
Valid at fold-2: mse-0.372654
Traing Log at fold-2 epoch-93: mse-0.075162, rmse-0.274158, r2-0.913221
Valid at fold-2: mse-0.364016
Update best_mse, Valid at fold-2 epoch-93: mse-0.364016, rmse-0.603338, ci--1, r2-0.603653, pearson-0.78711, spearman-0.746734
Traing Log at fold-2 epoch-94: mse-0.075723, rmse-0.275177, r2-0.912679
Valid at fold-2: mse-0.381342
Traing Log at fold-2 epoch-95: mse-0.075991, rmse-0.275664, r2-0.912213
Valid at fold-2: mse-0.36793
Traing Log at fold-2 epoch-96: mse-0.074678, rmse-0.273273, r2-0.913611
Valid at fold-2: mse-0.371704
Traing Log at fold-2 epoch-97: mse-0.074368, rmse-0.272704, r2-0.914307
Valid at fold-2: mse-0.367871
Traing Log at fold-2 epoch-98: mse-0.073561, rmse-0.271222, r2-0.9149
Valid at fold-2: mse-0.370734
Traing Log at fold-2 epoch-99: mse-0.074463, rmse-0.27288, r2-0.91432
Valid at fold-2: mse-0.365937
Traing Log at fold-2 epoch-100: mse-0.071288, rmse-0.266999, r2-0.917802
Valid at fold-2: mse-0.373477
Traing Log at fold-2 epoch-101: mse-0.07039, rmse-0.265312, r2-0.919163
Valid at fold-2: mse-0.374165
Traing Log at fold-2 epoch-102: mse-0.071257, rmse-0.266939, r2-0.918139
Valid at fold-2: mse-0.365476
Traing Log at fold-2 epoch-103: mse-0.071952, rmse-0.268239, r2-0.917184
Valid at fold-2: mse-0.369227
Traing Log at fold-2 epoch-104: mse-0.070254, rmse-0.265054, r2-0.919299
Valid at fold-2: mse-0.36689
Traing Log at fold-2 epoch-105: mse-0.070548, rmse-0.265609, r2-0.919005
Valid at fold-2: mse-0.368069
Traing Log at fold-2 epoch-106: mse-0.069212, rmse-0.263082, r2-0.920475
Valid at fold-2: mse-0.368699
Traing Log at fold-2 epoch-107: mse-0.068665, rmse-0.26204, r2-0.921246
Valid at fold-2: mse-0.364315
Traing Log at fold-2 epoch-108: mse-0.067712, rmse-0.260215, r2-0.922518
Valid at fold-2: mse-0.362699
Update best_mse, Valid at fold-2 epoch-108: mse-0.362699, rmse-0.602245, ci--1, r2-0.605088, pearson-0.784382, spearman-0.746114
Traing Log at fold-2 epoch-109: mse-0.066532, rmse-0.257938, r2-0.924011
Valid at fold-2: mse-0.360507
Update best_mse, Valid at fold-2 epoch-109: mse-0.360507, rmse-0.600422, ci--1, r2-0.607474, pearson-0.788195, spearman-0.75159
Traing Log at fold-2 epoch-110: mse-0.065169, rmse-0.255282, r2-0.925522
Valid at fold-2: mse-0.361007
Traing Log at fold-2 epoch-111: mse-0.067111, rmse-0.259057, r2-0.923179
Valid at fold-2: mse-0.364125
Traing Log at fold-2 epoch-112: mse-0.065872, rmse-0.256655, r2-0.924856
Valid at fold-2: mse-0.356643
Update best_mse, Valid at fold-2 epoch-112: mse-0.356643, rmse-0.597196, ci--1, r2-0.611681, pearson-0.788907, spearman-0.750106
Traing Log at fold-2 epoch-113: mse-0.063067, rmse-0.251132, r2-0.928188
Valid at fold-2: mse-0.356923
Traing Log at fold-2 epoch-114: mse-0.064429, rmse-0.253829, r2-0.926657
Valid at fold-2: mse-0.356511
Update best_mse, Valid at fold-2 epoch-114: mse-0.356511, rmse-0.597085, ci--1, r2-0.611825, pearson-0.788513, spearman-0.752107
Traing Log at fold-2 epoch-115: mse-0.064215, rmse-0.253406, r2-0.926478
Valid at fold-2: mse-0.358411
Traing Log at fold-2 epoch-116: mse-0.062795, rmse-0.25059, r2-0.928447
Valid at fold-2: mse-0.372135
Traing Log at fold-2 epoch-117: mse-0.063085, rmse-0.251168, r2-0.928268
Valid at fold-2: mse-0.360087
Traing Log at fold-2 epoch-118: mse-0.062933, rmse-0.250865, r2-0.928189
Valid at fold-2: mse-0.362581
Traing Log at fold-2 epoch-119: mse-0.061963, rmse-0.248923, r2-0.929535
Valid at fold-2: mse-0.363022
Traing Log at fold-2 epoch-120: mse-0.062362, rmse-0.249723, r2-0.92899
Valid at fold-2: mse-0.357846
Traing Log at fold-2 epoch-121: mse-0.062253, rmse-0.249506, r2-0.929115
Valid at fold-2: mse-0.363097
Traing Log at fold-2 epoch-122: mse-0.062007, rmse-0.249013, r2-0.929589
Valid at fold-2: mse-0.369016
Traing Log at fold-2 epoch-123: mse-0.061761, rmse-0.248518, r2-0.929622
Valid at fold-2: mse-0.371611
Traing Log at fold-2 epoch-124: mse-0.057722, rmse-0.240254, r2-0.934685
Valid at fold-2: mse-0.360878
Traing Log at fold-2 epoch-125: mse-0.059705, rmse-0.244346, r2-0.932354
Valid at fold-2: mse-0.354564
Update best_mse, Valid at fold-2 epoch-125: mse-0.354564, rmse-0.595453, ci--1, r2-0.613945, pearson-0.791217, spearman-0.755069
Traing Log at fold-2 epoch-126: mse-0.059254, rmse-0.243421, r2-0.932788
Valid at fold-2: mse-0.353177
Update best_mse, Valid at fold-2 epoch-126: mse-0.353177, rmse-0.594287, ci--1, r2-0.615455, pearson-0.794397, spearman-0.75752
Traing Log at fold-2 epoch-127: mse-0.057705, rmse-0.240218, r2-0.934597
Valid at fold-2: mse-0.364204
Traing Log at fold-2 epoch-128: mse-0.057722, rmse-0.240255, r2-0.934585
Valid at fold-2: mse-0.354202
Traing Log at fold-2 epoch-129: mse-0.056447, rmse-0.237586, r2-0.936059
Valid at fold-2: mse-0.357436
Traing Log at fold-2 epoch-130: mse-0.059447, rmse-0.243817, r2-0.93275
Valid at fold-2: mse-0.359038
Traing Log at fold-2 epoch-131: mse-0.058146, rmse-0.241134, r2-0.934087
Valid at fold-2: mse-0.356838
Traing Log at fold-2 epoch-132: mse-0.056171, rmse-0.237005, r2-0.936573
Valid at fold-2: mse-0.357265
Traing Log at fold-2 epoch-133: mse-0.054548, rmse-0.233554, r2-0.938363
Valid at fold-2: mse-0.361086
Traing Log at fold-2 epoch-134: mse-0.055837, rmse-0.236299, r2-0.936911
Valid at fold-2: mse-0.352738
Update best_mse, Valid at fold-2 epoch-134: mse-0.352738, rmse-0.593918, ci--1, r2-0.615933, pearson-0.791816, spearman-0.753231
Traing Log at fold-2 epoch-135: mse-0.057344, rmse-0.239467, r2-0.935107
Valid at fold-2: mse-0.353687
Traing Log at fold-2 epoch-136: mse-0.056718, rmse-0.238156, r2-0.935754
Valid at fold-2: mse-0.353362
Traing Log at fold-2 epoch-137: mse-0.054347, rmse-0.233125, r2-0.938611
Valid at fold-2: mse-0.354455
Traing Log at fold-2 epoch-138: mse-0.054584, rmse-0.233632, r2-0.938474
Valid at fold-2: mse-0.354651
Traing Log at fold-2 epoch-139: mse-0.054442, rmse-0.233328, r2-0.938519
Valid at fold-2: mse-0.36454
Traing Log at fold-2 epoch-140: mse-0.053992, rmse-0.232361, r2-0.93903
Valid at fold-2: mse-0.361706
Traing Log at fold-2 epoch-141: mse-0.053305, rmse-0.23088, r2-0.94013
Valid at fold-2: mse-0.347394
Update best_mse, Valid at fold-2 epoch-141: mse-0.347394, rmse-0.589402, ci--1, r2-0.621752, pearson-0.792473, spearman-0.757315
Traing Log at fold-2 epoch-142: mse-0.054155, rmse-0.232713, r2-0.938919
Valid at fold-2: mse-0.347493
Traing Log at fold-2 epoch-143: mse-0.05233, rmse-0.228758, r2-0.941074
Valid at fold-2: mse-0.35516
Traing Log at fold-2 epoch-144: mse-0.05261, rmse-0.229368, r2-0.940744
Valid at fold-2: mse-0.34869
Traing Log at fold-2 epoch-145: mse-0.052562, rmse-0.229264, r2-0.940842
Valid at fold-2: mse-0.354262
Traing Log at fold-2 epoch-146: mse-0.052822, rmse-0.229831, r2-0.94038
Valid at fold-2: mse-0.351738
Traing Log at fold-2 epoch-147: mse-0.051339, rmse-0.226581, r2-0.942229
Valid at fold-2: mse-0.359229
Traing Log at fold-2 epoch-148: mse-0.051786, rmse-0.227566, r2-0.941764
Valid at fold-2: mse-0.35491
Traing Log at fold-2 epoch-149: mse-0.051457, rmse-0.226842, r2-0.942138
Valid at fold-2: mse-0.356984
Traing Log at fold-2 epoch-150: mse-0.050486, rmse-0.22469, r2-0.943247
Valid at fold-2: mse-0.355455
Traing Log at fold-2 epoch-151: mse-0.050521, rmse-0.224768, r2-0.943241
Valid at fold-2: mse-0.359411
Traing Log at fold-2 epoch-152: mse-0.049102, rmse-0.22159, r2-0.944937
Valid at fold-2: mse-0.355008
Traing Log at fold-2 epoch-153: mse-0.049798, rmse-0.223154, r2-0.944117
Valid at fold-2: mse-0.356882
Traing Log at fold-2 epoch-154: mse-0.048074, rmse-0.219259, r2-0.946104
Valid at fold-2: mse-0.345965
Update best_mse, Valid at fold-2 epoch-154: mse-0.345965, rmse-0.588188, ci--1, r2-0.623308, pearson-0.793263, spearman-0.756152
Traing Log at fold-2 epoch-155: mse-0.049616, rmse-0.222746, r2-0.944401
Valid at fold-2: mse-0.354714
Traing Log at fold-2 epoch-156: mse-0.049355, rmse-0.222159, r2-0.944554
Valid at fold-2: mse-0.35835
Traing Log at fold-2 epoch-157: mse-0.050866, rmse-0.225536, r2-0.942672
Valid at fold-2: mse-0.35857
Traing Log at fold-2 epoch-158: mse-0.048551, rmse-0.220342, r2-0.945671
Valid at fold-2: mse-0.355587
Traing Log at fold-2 epoch-159: mse-0.046488, rmse-0.215611, r2-0.948089
Valid at fold-2: mse-0.353409
Traing Log at fold-2 epoch-160: mse-0.048677, rmse-0.220629, r2-0.945377
Valid at fold-2: mse-0.344792
Update best_mse, Valid at fold-2 epoch-160: mse-0.344792, rmse-0.58719, ci--1, r2-0.624585, pearson-0.794337, spearman-0.757574
Traing Log at fold-2 epoch-161: mse-0.048129, rmse-0.219384, r2-0.946032
Valid at fold-2: mse-0.355204
Traing Log at fold-2 epoch-162: mse-0.047697, rmse-0.218397, r2-0.946722
Valid at fold-2: mse-0.348809
Traing Log at fold-2 epoch-163: mse-0.047162, rmse-0.217167, r2-0.947133
Valid at fold-2: mse-0.350278
Traing Log at fold-2 epoch-164: mse-0.045759, rmse-0.213914, r2-0.948838
Valid at fold-2: mse-0.349031
Traing Log at fold-2 epoch-165: mse-0.048149, rmse-0.219428, r2-0.946025
Valid at fold-2: mse-0.35137
Traing Log at fold-2 epoch-166: mse-0.045683, rmse-0.213736, r2-0.948813
Valid at fold-2: mse-0.346776
Traing Log at fold-2 epoch-167: mse-0.047765, rmse-0.218551, r2-0.946496
Valid at fold-2: mse-0.350885
Traing Log at fold-2 epoch-168: mse-0.045965, rmse-0.214394, r2-0.948631
Valid at fold-2: mse-0.352058
Traing Log at fold-2 epoch-169: mse-0.044659, rmse-0.211326, r2-0.950186
Valid at fold-2: mse-0.350897
Traing Log at fold-2 epoch-170: mse-0.045273, rmse-0.212775, r2-0.949444
Valid at fold-2: mse-0.353814
Traing Log at fold-2 epoch-171: mse-0.046858, rmse-0.216466, r2-0.947558
Valid at fold-2: mse-0.355272
Traing Log at fold-2 epoch-172: mse-0.045547, rmse-0.213418, r2-0.949115
Valid at fold-2: mse-0.34403
Update best_mse, Valid at fold-2 epoch-172: mse-0.34403, rmse-0.586541, ci--1, r2-0.625415, pearson-0.798061, spearman-0.760416
Traing Log at fold-2 epoch-173: mse-0.043392, rmse-0.208307, r2-0.951522
Valid at fold-2: mse-0.345875
Traing Log at fold-2 epoch-174: mse-0.044548, rmse-0.211063, r2-0.950312
Valid at fold-2: mse-0.34558
Traing Log at fold-2 epoch-175: mse-0.042867, rmse-0.207043, r2-0.95221
Valid at fold-2: mse-0.34998
Traing Log at fold-2 epoch-176: mse-0.044374, rmse-0.210652, r2-0.95054
Valid at fold-2: mse-0.345015
Traing Log at fold-2 epoch-177: mse-0.044675, rmse-0.211366, r2-0.950025
Valid at fold-2: mse-0.344582
Traing Log at fold-2 epoch-178: mse-0.043013, rmse-0.207397, r2-0.952053
Valid at fold-2: mse-0.343458
Update best_mse, Valid at fold-2 epoch-178: mse-0.343458, rmse-0.586053, ci--1, r2-0.626038, pearson-0.795702, spearman-0.758347
Traing Log at fold-2 epoch-179: mse-0.043715, rmse-0.209081, r2-0.951245
Valid at fold-2: mse-0.345097
Traing Log at fold-2 epoch-180: mse-0.044244, rmse-0.210343, r2-0.950654
Valid at fold-2: mse-0.343449
Update best_mse, Valid at fold-2 epoch-180: mse-0.343449, rmse-0.586045, ci--1, r2-0.626047, pearson-0.798514, spearman-0.76228
Traing Log at fold-2 epoch-181: mse-0.042457, rmse-0.206052, r2-0.952777
Valid at fold-2: mse-0.344525
Traing Log at fold-2 epoch-182: mse-0.042931, rmse-0.207199, r2-0.952007
Valid at fold-2: mse-0.349306
Traing Log at fold-2 epoch-183: mse-0.044352, rmse-0.210598, r2-0.950628
Valid at fold-2: mse-0.342509
Update best_mse, Valid at fold-2 epoch-183: mse-0.342509, rmse-0.585243, ci--1, r2-0.62707, pearson-0.798001, spearman-0.760975
Traing Log at fold-2 epoch-184: mse-0.042013, rmse-0.20497, r2-0.953223
Valid at fold-2: mse-0.342805
Traing Log at fold-2 epoch-185: mse-0.042623, rmse-0.206454, r2-0.95242
Valid at fold-2: mse-0.346753
Traing Log at fold-2 epoch-186: mse-0.041404, rmse-0.203479, r2-0.95402
Valid at fold-2: mse-0.347247
Traing Log at fold-2 epoch-187: mse-0.040827, rmse-0.202057, r2-0.954583
Valid at fold-2: mse-0.346154
Traing Log at fold-2 epoch-188: mse-0.042737, rmse-0.206728, r2-0.95245
Valid at fold-2: mse-0.350911
Traing Log at fold-2 epoch-189: mse-0.042551, rmse-0.206279, r2-0.95246
Valid at fold-2: mse-0.342229
Update best_mse, Valid at fold-2 epoch-189: mse-0.342229, rmse-0.585003, ci--1, r2-0.627376, pearson-0.797502, spearman-0.760528
Traing Log at fold-2 epoch-190: mse-0.041343, rmse-0.203329, r2-0.954046
Valid at fold-2: mse-0.342376
Traing Log at fold-2 epoch-191: mse-0.041978, rmse-0.204884, r2-0.953251
Valid at fold-2: mse-0.347547
Traing Log at fold-2 epoch-192: mse-0.040621, rmse-0.201547, r2-0.954845
Valid at fold-2: mse-0.349026
Traing Log at fold-2 epoch-193: mse-0.040807, rmse-0.202008, r2-0.954632
Valid at fold-2: mse-0.340461
Update best_mse, Valid at fold-2 epoch-193: mse-0.340461, rmse-0.583491, ci--1, r2-0.6293, pearson-0.799305, spearman-0.763657
Traing Log at fold-2 epoch-194: mse-0.041403, rmse-0.203477, r2-0.953914
Valid at fold-2: mse-0.345445
Traing Log at fold-2 epoch-195: mse-0.039656, rmse-0.199139, r2-0.956071
Valid at fold-2: mse-0.344268
Traing Log at fold-2 epoch-196: mse-0.039768, rmse-0.19942, r2-0.955755
Valid at fold-2: mse-0.339897
Update best_mse, Valid at fold-2 epoch-196: mse-0.339897, rmse-0.583007, ci--1, r2-0.629915, pearson-0.800799, spearman-0.762901
Traing Log at fold-2 epoch-197: mse-0.040426, rmse-0.201063, r2-0.955039
Valid at fold-2: mse-0.345534
Traing Log at fold-2 epoch-198: mse-0.040249, rmse-0.200621, r2-0.95523
Valid at fold-2: mse-0.348388
Traing Log at fold-2 epoch-199: mse-0.040356, rmse-0.200888, r2-0.955228
Valid at fold-2: mse-0.339675
Update best_mse, Valid at fold-2 epoch-199: mse-0.339675, rmse-0.582816, ci--1, r2-0.630156, pearson-0.800045, spearman-0.763162
Traing Log at fold-2 epoch-200: mse-0.039994, rmse-0.199984, r2-0.955555
Valid at fold-2: mse-0.345271
Save log over at ./log/Nov13_11-09-21-metz-novel-pair-fold2.csv

============================================================
Testing fold 2 with best model...
============================================================
/home/minhtrin/.conda/envs/LLMDTA/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:144: FutureWarning: `torch.nn.utils.weight_norm` is deprecated in favor of `torch.nn.utils.parametrizations.weight_norm`.
  WeightNorm.apply(module, name, dim)
Test at fold-2, mse: 0.684396, rmse: 0.827283, ci: 0.667955, r2: 0.241748, pearson: 0.522506, spearman: 0.456088

Fold 2 results saved to: ./log/Test-metz-novel-pair-fold2-Nov13_11-09-21.csv
============================================================
Training fold 2 completed successfully!
============================================================
wandb: updating run metadata
wandb: uploading output.log; uploading wandb-summary.json
wandb: uploading history steps 449-449, summary, console lines 464-469
wandb: 
wandb: Run history:
wandb:      best_valid/mse â–ˆâ–‡â–…â–„â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb:  best_valid/pearson â–â–„â–„â–…â–…â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:       best_valid/r2 â–â–‚â–„â–…â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:     best_valid/rmse â–ˆâ–‡â–…â–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb: best_valid/spearman â–â–„â–„â–„â–…â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:               epoch â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–„â–…â–…â–…â–…â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:             test/ci â–
wandb:            test/mse â–
wandb:        test/pearson â–
wandb:             test/r2 â–
wandb:                 +13 ...
wandb: 
wandb: Run summary:
wandb:      best_valid/mse 0.33968
wandb:  best_valid/pearson 0.80005
wandb:       best_valid/r2 0.63016
wandb:     best_valid/rmse 0.58282
wandb: best_valid/spearman 0.76316
wandb:               epoch 200
wandb:       final_test_ci 0.66795
wandb:      final_test_mse 0.6844
wandb:  final_test_pearson 0.52251
wandb:       final_test_r2 0.24175
wandb:                 +19 ...
wandb: 
wandb: ğŸš€ View run metz-novel-pair-fold2 at: https://wandb.ai/tringuyen/LLMDTA/runs/9x5gi9bv
wandb: â­ï¸ View project at: https://wandb.ai/tringuyen/LLMDTA
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251113_110922-9x5gi9bv/logs
Weights & Biases run finished

Training for fold 2 completed successfully.
Python script exit code: 0
==========================================
End Time: Thu Nov 13 09:17:00 PM AEDT 2025
==========================================
