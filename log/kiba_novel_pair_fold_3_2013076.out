==========================================
Job ID: 2013076
Array Task ID: 3
Node: v100l-f-01
Start Time: Thu Nov 13 07:15:43 AM AEDT 2025
==========================================
Activating conda environment...
Conda environment activated: LLMDTA
Checking GPU...
Thu Nov 13 07:15:43 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 565.57.01              Driver Version: 565.57.01      CUDA Version: 12.7     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-SXM2-32GB           On  |   00000000:85:00.0 Off |                    0 |
| N/A   29C    P0             40W /  300W |       1MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Setting environment variables...

Starting training for fold 3...


============================================================
Starting training for Fold 3
Dataset: kiba, Running Set: novel-pair
Epochs: 200, Batch Size: 16
============================================================

Executing: python -u code/train.py --fold 3 --cuda 0 --dataset kiba --running_set novel-pair --epochs 200 --batch_size 16 --wandb_project LLMDTA
============================================================
Training Fold 3/4
Dataset: kiba-novel-pair
Device: cuda (CUDA_VISIBLE_DEVICES=0)
Pretrain-./data/kiba/kiba_drug_pretrain.pkl
Pretrain-./data/kiba/kiba_esm_pretrain.pkl
============================================================
wandb: Currently logged in as: tringuyen to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: WARNING Using a boolean value for 'reinit' is deprecated. Use 'return_previous' or 'finish_previous' instead.
wandb: setting up run jz0z4f9g
wandb: Tracking run with wandb version 0.23.0
wandb: Run data is saved locally in /vast/minhtrin/DTA/Temp/wandb/run-20251113_071550-jz0z4f9g
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run kiba-novel-pair-fold3
wandb: â­ï¸ View project at https://wandb.ai/tringuyen/LLMDTA
wandb: ğŸš€ View run at https://wandb.ai/tringuyen/LLMDTA/runs/jz0z4f9g
Weights & Biases initialized: LLMDTA
Loading fold 3 data...
  Train: ./data/dta-5fold-dataset/kiba/novel-pair/fold_3_train.csv
  Valid: ./data/dta-5fold-dataset/kiba/novel-pair/fold_3_valid.csv
  Test:  ./data/dta-5fold-dataset/kiba/novel-pair/fold_3_test.csv
Dataset loaded: 40730 train, 57459 valid, 20065 test samples
/home/minhtrin/.conda/envs/LLMDTA/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:144: FutureWarning: `torch.nn.utils.weight_norm` is deprecated in favor of `torch.nn.utils.parametrizations.weight_norm`.
  WeightNorm.apply(module, name, dim)
Traing Log at fold-3 epoch-1: mse-3.807341, rmse-1.951241, r2--0.127231
Valid at fold-3: mse-2.560404
Update best_mse, Valid at fold-3 epoch-1: mse-2.560404, rmse-1.600126, ci--1, r2--2.640878, pearson-0.389014, spearman-0.375496
Traing Log at fold-3 epoch-2: mse-0.586501, rmse-0.765834, r2--0.313463
Valid at fold-3: mse-0.641471
Update best_mse, Valid at fold-3 epoch-2: mse-0.641471, rmse-0.800919, ci--1, r2-0.087832, pearson-0.530436, spearman-0.50708
Traing Log at fold-3 epoch-3: mse-0.457312, rmse-0.676249, r2--0.112134
Valid at fold-3: mse-0.458895
Update best_mse, Valid at fold-3 epoch-3: mse-0.458895, rmse-0.677418, ci--1, r2-0.347454, pearson-0.607654, spearman-0.541805
Traing Log at fold-3 epoch-4: mse-0.392757, rmse-0.626703, r2-0.045406
Valid at fold-3: mse-0.453804
Update best_mse, Valid at fold-3 epoch-4: mse-0.453804, rmse-0.67365, ci--1, r2-0.354694, pearson-0.632517, spearman-0.605853
Traing Log at fold-3 epoch-5: mse-0.355356, rmse-0.596117, r2-0.16953
Valid at fold-3: mse-0.398172
Update best_mse, Valid at fold-3 epoch-5: mse-0.398172, rmse-0.631008, ci--1, r2-0.433803, pearson-0.667923, spearman-0.619831
Traing Log at fold-3 epoch-6: mse-0.324089, rmse-0.569288, r2-0.279507
Valid at fold-3: mse-0.385437
Update best_mse, Valid at fold-3 epoch-6: mse-0.385437, rmse-0.620836, ci--1, r2-0.451911, pearson-0.679833, spearman-0.620191
Traing Log at fold-3 epoch-7: mse-0.306318, rmse-0.55346, r2-0.338587
Valid at fold-3: mse-0.373021
Update best_mse, Valid at fold-3 epoch-7: mse-0.373021, rmse-0.610755, ci--1, r2-0.469566, pearson-0.688682, spearman-0.635662
Traing Log at fold-3 epoch-8: mse-0.283177, rmse-0.532144, r2-0.414564
Valid at fold-3: mse-0.358147
Update best_mse, Valid at fold-3 epoch-8: mse-0.358147, rmse-0.598454, ci--1, r2-0.490717, pearson-0.702391, spearman-0.653248
Traing Log at fold-3 epoch-9: mse-0.270963, rmse-0.520541, r2-0.453393
Valid at fold-3: mse-0.348613
Update best_mse, Valid at fold-3 epoch-9: mse-0.348613, rmse-0.590435, ci--1, r2-0.504275, pearson-0.715237, spearman-0.680216
Traing Log at fold-3 epoch-10: mse-0.260984, rmse-0.510866, r2-0.484013
Valid at fold-3: mse-0.353983
Traing Log at fold-3 epoch-11: mse-0.246459, rmse-0.496446, r2-0.525137
Valid at fold-3: mse-0.345557
Update best_mse, Valid at fold-3 epoch-11: mse-0.345557, rmse-0.587841, ci--1, r2-0.508621, pearson-0.718351, spearman-0.659923
Traing Log at fold-3 epoch-12: mse-0.238207, rmse-0.488065, r2-0.548357
Valid at fold-3: mse-0.338917
Update best_mse, Valid at fold-3 epoch-12: mse-0.338917, rmse-0.582166, ci--1, r2-0.518062, pearson-0.724969, spearman-0.681115
Traing Log at fold-3 epoch-13: mse-0.230441, rmse-0.480042, r2-0.567398
Valid at fold-3: mse-0.339704
Traing Log at fold-3 epoch-14: mse-0.224061, rmse-0.473351, r2-0.585573
Valid at fold-3: mse-0.327991
Update best_mse, Valid at fold-3 epoch-14: mse-0.327991, rmse-0.572705, ci--1, r2-0.533599, pearson-0.740523, spearman-0.689759
Traing Log at fold-3 epoch-15: mse-0.215952, rmse-0.464706, r2-0.605924
Valid at fold-3: mse-0.337977
Traing Log at fold-3 epoch-16: mse-0.209407, rmse-0.45761, r2-0.622906
Valid at fold-3: mse-0.329858
Traing Log at fold-3 epoch-17: mse-0.203022, rmse-0.45058, r2-0.637839
Valid at fold-3: mse-0.325249
Update best_mse, Valid at fold-3 epoch-17: mse-0.325249, rmse-0.570306, ci--1, r2-0.537497, pearson-0.734913, spearman-0.678461
Traing Log at fold-3 epoch-18: mse-0.196818, rmse-0.443642, r2-0.652448
Valid at fold-3: mse-0.326222
Traing Log at fold-3 epoch-19: mse-0.190422, rmse-0.436374, r2-0.668401
Valid at fold-3: mse-0.32581
Traing Log at fold-3 epoch-20: mse-0.186186, rmse-0.431493, r2-0.678024
Valid at fold-3: mse-0.318439
Update best_mse, Valid at fold-3 epoch-20: mse-0.318439, rmse-0.564304, ci--1, r2-0.547182, pearson-0.745973, spearman-0.697061
Traing Log at fold-3 epoch-21: mse-0.183904, rmse-0.42884, r2-0.683111
Valid at fold-3: mse-0.312869
Update best_mse, Valid at fold-3 epoch-21: mse-0.312869, rmse-0.559347, ci--1, r2-0.555102, pearson-0.747548, spearman-0.695991
Traing Log at fold-3 epoch-22: mse-0.176893, rmse-0.420587, r2-0.698622
Valid at fold-3: mse-0.310923
Update best_mse, Valid at fold-3 epoch-22: mse-0.310923, rmse-0.557605, ci--1, r2-0.55787, pearson-0.750921, spearman-0.698396
Traing Log at fold-3 epoch-23: mse-0.17362, rmse-0.416678, r2-0.70567
Valid at fold-3: mse-0.322864
Traing Log at fold-3 epoch-24: mse-0.169604, rmse-0.41183, r2-0.714976
Valid at fold-3: mse-0.319634
Traing Log at fold-3 epoch-25: mse-0.16747, rmse-0.409231, r2-0.718923
Valid at fold-3: mse-0.314885
Traing Log at fold-3 epoch-26: mse-0.162297, rmse-0.402861, r2-0.73027
Valid at fold-3: mse-0.312557
Traing Log at fold-3 epoch-27: mse-0.157885, rmse-0.397347, r2-0.740129
Valid at fold-3: mse-0.321891
Traing Log at fold-3 epoch-28: mse-0.155906, rmse-0.39485, r2-0.742968
Valid at fold-3: mse-0.303784
Update best_mse, Valid at fold-3 epoch-28: mse-0.303784, rmse-0.551166, ci--1, r2-0.568021, pearson-0.757338, spearman-0.703743
Traing Log at fold-3 epoch-29: mse-0.153172, rmse-0.391372, r2-0.748976
Valid at fold-3: mse-0.315032
Traing Log at fold-3 epoch-30: mse-0.14689, rmse-0.383262, r2-0.762059
Valid at fold-3: mse-0.312009
Traing Log at fold-3 epoch-31: mse-0.147159, rmse-0.383613, r2-0.761659
Valid at fold-3: mse-0.301199
Update best_mse, Valid at fold-3 epoch-31: mse-0.301199, rmse-0.548816, ci--1, r2-0.571697, pearson-0.758844, spearman-0.698016
Traing Log at fold-3 epoch-32: mse-0.14302, rmse-0.37818, r2-0.769491
Valid at fold-3: mse-0.303194
Traing Log at fold-3 epoch-33: mse-0.137387, rmse-0.370657, r2-0.780192
Valid at fold-3: mse-0.310596
Traing Log at fold-3 epoch-34: mse-0.138013, rmse-0.3715, r2-0.779933
Valid at fold-3: mse-0.316261
Traing Log at fold-3 epoch-35: mse-0.135427, rmse-0.368005, r2-0.784547
Valid at fold-3: mse-0.314701
Traing Log at fold-3 epoch-36: mse-0.131519, rmse-0.362655, r2-0.791711
Valid at fold-3: mse-0.305919
Traing Log at fold-3 epoch-37: mse-0.129436, rmse-0.359772, r2-0.795958
Valid at fold-3: mse-0.29932
Update best_mse, Valid at fold-3 epoch-37: mse-0.29932, rmse-0.547102, ci--1, r2-0.574368, pearson-0.769637, spearman-0.708395
Traing Log at fold-3 epoch-38: mse-0.127853, rmse-0.357565, r2-0.799038
Valid at fold-3: mse-0.301923
Traing Log at fold-3 epoch-39: mse-0.124689, rmse-0.353113, r2-0.804975
Valid at fold-3: mse-0.315006
Traing Log at fold-3 epoch-40: mse-0.122843, rmse-0.350489, r2-0.808349
Valid at fold-3: mse-0.309081
Traing Log at fold-3 epoch-41: mse-0.120147, rmse-0.346623, r2-0.813281
Valid at fold-3: mse-0.312091
Traing Log at fold-3 epoch-42: mse-0.118196, rmse-0.343797, r2-0.817261
Valid at fold-3: mse-0.310082
Traing Log at fold-3 epoch-43: mse-0.115478, rmse-0.339821, r2-0.821536
Valid at fold-3: mse-0.290664
Update best_mse, Valid at fold-3 epoch-43: mse-0.290664, rmse-0.539132, ci--1, r2-0.586678, pearson-0.773023, spearman-0.718373
Traing Log at fold-3 epoch-44: mse-0.114821, rmse-0.338853, r2-0.823123
Valid at fold-3: mse-0.296597
Traing Log at fold-3 epoch-45: mse-0.111407, rmse-0.333777, r2-0.829563
Valid at fold-3: mse-0.30628
Traing Log at fold-3 epoch-46: mse-0.110282, rmse-0.332087, r2-0.831114
Valid at fold-3: mse-0.298222
Traing Log at fold-3 epoch-47: mse-0.109484, rmse-0.330884, r2-0.832697
Valid at fold-3: mse-0.293854
Traing Log at fold-3 epoch-48: mse-0.106018, rmse-0.325605, r2-0.838832
Valid at fold-3: mse-0.295397
Traing Log at fold-3 epoch-49: mse-0.104258, rmse-0.32289, r2-0.84222
Valid at fold-3: mse-0.29516
Traing Log at fold-3 epoch-50: mse-0.104464, rmse-0.323209, r2-0.841313
Valid at fold-3: mse-0.307744
Traing Log at fold-3 epoch-51: mse-0.100238, rmse-0.316604, r2-0.849122
Valid at fold-3: mse-0.294947
Traing Log at fold-3 epoch-52: mse-0.100279, rmse-0.316669, r2-0.848805
Valid at fold-3: mse-0.431243
Traing Log at fold-3 epoch-53: mse-0.105726, rmse-0.325155, r2-0.840756
Valid at fold-3: mse-0.291447
Traing Log at fold-3 epoch-54: mse-0.096397, rmse-0.310479, r2-0.855405
Valid at fold-3: mse-0.290009
Update best_mse, Valid at fold-3 epoch-54: mse-0.290009, rmse-0.538525, ci--1, r2-0.587609, pearson-0.776261, spearman-0.721213
Traing Log at fold-3 epoch-55: mse-0.094472, rmse-0.307363, r2-0.859115
Valid at fold-3: mse-0.304473
Traing Log at fold-3 epoch-56: mse-0.094505, rmse-0.307417, r2-0.858679
Valid at fold-3: mse-0.299939
Traing Log at fold-3 epoch-57: mse-0.094893, rmse-0.308047, r2-0.858252
Valid at fold-3: mse-0.301781
Traing Log at fold-3 epoch-58: mse-0.091321, rmse-0.302193, r2-0.864116
Valid at fold-3: mse-0.293806
Traing Log at fold-3 epoch-59: mse-0.091523, rmse-0.302528, r2-0.864127
Valid at fold-3: mse-0.295675
Traing Log at fold-3 epoch-60: mse-0.090732, rmse-0.301217, r2-0.865162
Valid at fold-3: mse-0.304877
Traing Log at fold-3 epoch-61: mse-0.088918, rmse-0.298192, r2-0.868368
Valid at fold-3: mse-0.299015
Traing Log at fold-3 epoch-62: mse-0.087841, rmse-0.29638, r2-0.870199
Valid at fold-3: mse-0.306581
Traing Log at fold-3 epoch-63: mse-0.08697, rmse-0.294906, r2-0.871589
Valid at fold-3: mse-0.299973
Traing Log at fold-3 epoch-64: mse-0.086085, rmse-0.293403, r2-0.872991
Valid at fold-3: mse-0.289194
Update best_mse, Valid at fold-3 epoch-64: mse-0.289194, rmse-0.537767, ci--1, r2-0.588769, pearson-0.780173, spearman-0.719593
Traing Log at fold-3 epoch-65: mse-0.083602, rmse-0.289139, r2-0.877011
Valid at fold-3: mse-0.294438
Traing Log at fold-3 epoch-66: mse-0.082648, rmse-0.287486, r2-0.878886
Valid at fold-3: mse-0.291327
Traing Log at fold-3 epoch-67: mse-0.081566, rmse-0.285598, r2-0.880458
Valid at fold-3: mse-0.288088
Update best_mse, Valid at fold-3 epoch-67: mse-0.288088, rmse-0.536738, ci--1, r2-0.590341, pearson-0.77997, spearman-0.721933
Traing Log at fold-3 epoch-68: mse-0.079883, rmse-0.282637, r2-0.883165
Valid at fold-3: mse-0.287275
Update best_mse, Valid at fold-3 epoch-68: mse-0.287275, rmse-0.53598, ci--1, r2-0.591497, pearson-0.782655, spearman-0.720071
Traing Log at fold-3 epoch-69: mse-0.080539, rmse-0.283794, r2-0.882249
Valid at fold-3: mse-0.293477
Traing Log at fold-3 epoch-70: mse-0.078616, rmse-0.280385, r2-0.885288
Valid at fold-3: mse-0.288191
Traing Log at fold-3 epoch-71: mse-0.07684, rmse-0.277201, r2-0.887935
Valid at fold-3: mse-0.29011
Traing Log at fold-3 epoch-72: mse-0.076695, rmse-0.276939, r2-0.8884
Valid at fold-3: mse-0.288746
Traing Log at fold-3 epoch-73: mse-0.07463, rmse-0.273185, r2-0.891764
Valid at fold-3: mse-0.285949
Update best_mse, Valid at fold-3 epoch-73: mse-0.285949, rmse-0.534742, ci--1, r2-0.593383, pearson-0.778595, spearman-0.7138
Traing Log at fold-3 epoch-74: mse-0.07529, rmse-0.274389, r2-0.890693
Valid at fold-3: mse-0.285617
Update best_mse, Valid at fold-3 epoch-74: mse-0.285617, rmse-0.534431, ci--1, r2-0.593855, pearson-0.782442, spearman-0.721265
Traing Log at fold-3 epoch-75: mse-0.074556, rmse-0.273049, r2-0.891867
Valid at fold-3: mse-0.290593
Traing Log at fold-3 epoch-76: mse-0.071847, rmse-0.268044, r2-0.896112
Valid at fold-3: mse-0.282633
Update best_mse, Valid at fold-3 epoch-76: mse-0.282633, rmse-0.531632, ci--1, r2-0.598098, pearson-0.781406, spearman-0.724798
Traing Log at fold-3 epoch-77: mse-0.072825, rmse-0.269861, r2-0.894739
Valid at fold-3: mse-0.287979
Traing Log at fold-3 epoch-78: mse-0.071552, rmse-0.267492, r2-0.896473
Valid at fold-3: mse-0.287715
Traing Log at fold-3 epoch-79: mse-0.070302, rmse-0.265144, r2-0.898567
Valid at fold-3: mse-0.296072
Traing Log at fold-3 epoch-80: mse-0.0699, rmse-0.264386, r2-0.899514
Valid at fold-3: mse-0.280827
Update best_mse, Valid at fold-3 epoch-80: mse-0.280827, rmse-0.529931, ci--1, r2-0.600666, pearson-0.780901, spearman-0.72042
Traing Log at fold-3 epoch-81: mse-0.069208, rmse-0.263074, r2-0.900311
Valid at fold-3: mse-0.285343
Traing Log at fold-3 epoch-82: mse-0.068845, rmse-0.262384, r2-0.900852
Valid at fold-3: mse-0.283188
Traing Log at fold-3 epoch-83: mse-0.066339, rmse-0.257563, r2-0.904829
Valid at fold-3: mse-0.282341
Traing Log at fold-3 epoch-84: mse-0.065236, rmse-0.255414, r2-0.906642
Valid at fold-3: mse-0.286386
Traing Log at fold-3 epoch-85: mse-0.065956, rmse-0.256819, r2-0.905512
Valid at fold-3: mse-0.286104
Traing Log at fold-3 epoch-86: mse-0.064137, rmse-0.253252, r2-0.908225
Valid at fold-3: mse-0.294244
Traing Log at fold-3 epoch-87: mse-0.063583, rmse-0.252157, r2-0.909131
Valid at fold-3: mse-0.289653
Traing Log at fold-3 epoch-88: mse-0.063262, rmse-0.251519, r2-0.909666
Valid at fold-3: mse-0.299551
Traing Log at fold-3 epoch-89: mse-0.061937, rmse-0.248871, r2-0.911919
Valid at fold-3: mse-0.281741
Traing Log at fold-3 epoch-90: mse-0.061806, rmse-0.248608, r2-0.911838
Valid at fold-3: mse-0.283769
Traing Log at fold-3 epoch-91: mse-0.061692, rmse-0.248379, r2-0.911935
Valid at fold-3: mse-0.285456
Traing Log at fold-3 epoch-92: mse-0.060725, rmse-0.246425, r2-0.913804
Valid at fold-3: mse-0.284491
Traing Log at fold-3 epoch-93: mse-0.059441, rmse-0.243805, r2-0.915535
Valid at fold-3: mse-0.289368
Traing Log at fold-3 epoch-94: mse-0.059881, rmse-0.244707, r2-0.914963
Valid at fold-3: mse-0.28446
Traing Log at fold-3 epoch-95: mse-0.058407, rmse-0.241675, r2-0.917102
Valid at fold-3: mse-0.28412
Traing Log at fold-3 epoch-96: mse-0.0589, rmse-0.242694, r2-0.916498
Valid at fold-3: mse-0.278547
Update best_mse, Valid at fold-3 epoch-96: mse-0.278547, rmse-0.527776, ci--1, r2-0.603908, pearson-0.787202, spearman-0.730983
Traing Log at fold-3 epoch-97: mse-0.05716, rmse-0.239082, r2-0.919057
Valid at fold-3: mse-0.278064
Update best_mse, Valid at fold-3 epoch-97: mse-0.278064, rmse-0.527318, ci--1, r2-0.604594, pearson-0.786402, spearman-0.729706
Traing Log at fold-3 epoch-98: mse-0.057346, rmse-0.23947, r2-0.918866
Valid at fold-3: mse-0.277405
Update best_mse, Valid at fold-3 epoch-98: mse-0.277405, rmse-0.526692, ci--1, r2-0.605532, pearson-0.78687, spearman-0.728661
Traing Log at fold-3 epoch-99: mse-0.056725, rmse-0.23817, r2-0.919622
Valid at fold-3: mse-0.276823
Update best_mse, Valid at fold-3 epoch-99: mse-0.276823, rmse-0.52614, ci--1, r2-0.606359, pearson-0.786984, spearman-0.733532
Traing Log at fold-3 epoch-100: mse-0.056859, rmse-0.238451, r2-0.919587
Valid at fold-3: mse-0.282078
Traing Log at fold-3 epoch-101: mse-0.055173, rmse-0.234889, r2-0.922027
Valid at fold-3: mse-0.283345
Traing Log at fold-3 epoch-102: mse-0.054069, rmse-0.232528, r2-0.923915
Valid at fold-3: mse-0.277094
Traing Log at fold-3 epoch-103: mse-0.054326, rmse-0.23308, r2-0.923271
Valid at fold-3: mse-0.284262
Traing Log at fold-3 epoch-104: mse-0.054145, rmse-0.23269, r2-0.923797
Valid at fold-3: mse-0.273152
Update best_mse, Valid at fold-3 epoch-104: mse-0.273152, rmse-0.52264, ci--1, r2-0.611579, pearson-0.787214, spearman-0.730397
Traing Log at fold-3 epoch-105: mse-0.053803, rmse-0.231955, r2-0.923939
Valid at fold-3: mse-0.27601
Traing Log at fold-3 epoch-106: mse-0.052883, rmse-0.229963, r2-0.925603
Valid at fold-3: mse-0.285962
Traing Log at fold-3 epoch-107: mse-0.051829, rmse-0.22766, r2-0.927178
Valid at fold-3: mse-0.279344
Traing Log at fold-3 epoch-108: mse-0.052165, rmse-0.228397, r2-0.926713
Valid at fold-3: mse-0.286964
Traing Log at fold-3 epoch-109: mse-0.050876, rmse-0.225557, r2-0.928541
Valid at fold-3: mse-0.277914
Traing Log at fold-3 epoch-110: mse-0.049822, rmse-0.223208, r2-0.930126
Valid at fold-3: mse-0.281556
Traing Log at fold-3 epoch-111: mse-0.049714, rmse-0.222965, r2-0.930373
Valid at fold-3: mse-0.278935
Traing Log at fold-3 epoch-112: mse-0.049739, rmse-0.223024, r2-0.930124
Valid at fold-3: mse-0.285481
Traing Log at fold-3 epoch-113: mse-0.050139, rmse-0.223918, r2-0.929797
Valid at fold-3: mse-0.288375
Traing Log at fold-3 epoch-114: mse-0.048453, rmse-0.220121, r2-0.932229
Valid at fold-3: mse-0.279082
Traing Log at fold-3 epoch-115: mse-0.048082, rmse-0.219276, r2-0.932852
Valid at fold-3: mse-0.285406
Traing Log at fold-3 epoch-116: mse-0.048182, rmse-0.219503, r2-0.932549
Valid at fold-3: mse-0.275698
Traing Log at fold-3 epoch-117: mse-0.046461, rmse-0.215547, r2-0.935058
Valid at fold-3: mse-0.278562
Traing Log at fold-3 epoch-118: mse-0.046063, rmse-0.214624, r2-0.935755
Valid at fold-3: mse-0.274426
Traing Log at fold-3 epoch-119: mse-0.047523, rmse-0.217999, r2-0.933568
Valid at fold-3: mse-0.275506
Traing Log at fold-3 epoch-120: mse-0.045845, rmse-0.214114, r2-0.936105
Valid at fold-3: mse-0.276689
Traing Log at fold-3 epoch-121: mse-0.045718, rmse-0.213817, r2-0.936391
Valid at fold-3: mse-0.274972
Traing Log at fold-3 epoch-122: mse-0.045975, rmse-0.214418, r2-0.935827
Valid at fold-3: mse-0.270829
Update best_mse, Valid at fold-3 epoch-122: mse-0.270829, rmse-0.520412, ci--1, r2-0.614883, pearson-0.792171, spearman-0.73545
Traing Log at fold-3 epoch-123: mse-0.045026, rmse-0.212192, r2-0.9372
Valid at fold-3: mse-0.279298
Traing Log at fold-3 epoch-124: mse-0.044007, rmse-0.209778, r2-0.938828
Valid at fold-3: mse-0.274669
Traing Log at fold-3 epoch-125: mse-0.043536, rmse-0.208653, r2-0.93942
Valid at fold-3: mse-0.281668
Traing Log at fold-3 epoch-126: mse-0.044108, rmse-0.21002, r2-0.938746
Valid at fold-3: mse-0.275662
Traing Log at fold-3 epoch-127: mse-0.042666, rmse-0.206556, r2-0.940715
Valid at fold-3: mse-0.280884
Traing Log at fold-3 epoch-128: mse-0.042498, rmse-0.20615, r2-0.940998
Valid at fold-3: mse-0.272135
Traing Log at fold-3 epoch-129: mse-0.042882, rmse-0.207079, r2-0.940407
Valid at fold-3: mse-0.281418
Traing Log at fold-3 epoch-130: mse-0.042084, rmse-0.205144, r2-0.941665
Valid at fold-3: mse-0.271622
Traing Log at fold-3 epoch-131: mse-0.042265, rmse-0.205584, r2-0.941377
Valid at fold-3: mse-0.278391
Traing Log at fold-3 epoch-132: mse-0.041083, rmse-0.202691, r2-0.943068
Valid at fold-3: mse-0.276237
Traing Log at fold-3 epoch-133: mse-0.041112, rmse-0.202762, r2-0.943033
Valid at fold-3: mse-0.282001
Traing Log at fold-3 epoch-134: mse-0.04037, rmse-0.200924, r2-0.944131
Valid at fold-3: mse-0.273416
Traing Log at fold-3 epoch-135: mse-0.040727, rmse-0.201809, r2-0.943613
Valid at fold-3: mse-0.273273
Traing Log at fold-3 epoch-136: mse-0.039892, rmse-0.199729, r2-0.944776
Valid at fold-3: mse-0.275333
Traing Log at fold-3 epoch-137: mse-0.03943, rmse-0.19857, r2-0.945513
Valid at fold-3: mse-0.289572
Traing Log at fold-3 epoch-138: mse-0.039927, rmse-0.199818, r2-0.944777
Valid at fold-3: mse-0.277717
Traing Log at fold-3 epoch-139: mse-0.039079, rmse-0.197685, r2-0.945966
Valid at fold-3: mse-0.27353
Traing Log at fold-3 epoch-140: mse-0.038955, rmse-0.197369, r2-0.946237
Valid at fold-3: mse-0.277082
Traing Log at fold-3 epoch-141: mse-0.038198, rmse-0.195443, r2-0.947264
Valid at fold-3: mse-0.270871
Traing Log at fold-3 epoch-142: mse-0.03826, rmse-0.195603, r2-0.947193
Valid at fold-3: mse-0.273237
Traing Log at fold-3 epoch-143: mse-0.037427, rmse-0.19346, r2-0.948491
Valid at fold-3: mse-0.267218
Update best_mse, Valid at fold-3 epoch-143: mse-0.267218, rmse-0.516932, ci--1, r2-0.620017, pearson-0.794253, spearman-0.738083
Traing Log at fold-3 epoch-144: mse-0.037748, rmse-0.194289, r2-0.947896
Valid at fold-3: mse-0.270049
Traing Log at fold-3 epoch-145: mse-0.037451, rmse-0.193524, r2-0.94831
Valid at fold-3: mse-0.274772
Traing Log at fold-3 epoch-146: mse-0.037377, rmse-0.19333, r2-0.948453
Valid at fold-3: mse-0.270298
Traing Log at fold-3 epoch-147: mse-0.036599, rmse-0.191308, r2-0.949661
Valid at fold-3: mse-0.27209
Traing Log at fold-3 epoch-148: mse-0.035931, rmse-0.189553, r2-0.95054
Valid at fold-3: mse-0.270264
Traing Log at fold-3 epoch-149: mse-0.036397, rmse-0.190779, r2-0.949903
Valid at fold-3: mse-0.271634
Traing Log at fold-3 epoch-150: mse-0.036221, rmse-0.190317, r2-0.950096
Valid at fold-3: mse-0.272813
Traing Log at fold-3 epoch-151: mse-0.035053, rmse-0.187223, r2-0.951858
Valid at fold-3: mse-0.27049
Traing Log at fold-3 epoch-152: mse-0.034513, rmse-0.185777, r2-0.952538
Valid at fold-3: mse-0.270525
Traing Log at fold-3 epoch-153: mse-0.034748, rmse-0.186407, r2-0.952264
Valid at fold-3: mse-0.273831
Traing Log at fold-3 epoch-154: mse-0.034376, rmse-0.185408, r2-0.9528
Valid at fold-3: mse-0.271252
Traing Log at fold-3 epoch-155: mse-0.034437, rmse-0.185571, r2-0.952666
Valid at fold-3: mse-0.276815
Traing Log at fold-3 epoch-156: mse-0.034276, rmse-0.185137, r2-0.952946
Valid at fold-3: mse-0.27051
Traing Log at fold-3 epoch-157: mse-0.034255, rmse-0.185082, r2-0.953038
Valid at fold-3: mse-0.268385
Traing Log at fold-3 epoch-158: mse-0.033535, rmse-0.183126, r2-0.953907
Valid at fold-3: mse-0.275527
Traing Log at fold-3 epoch-159: mse-0.03322, rmse-0.182264, r2-0.95454
Valid at fold-3: mse-0.266927
Update best_mse, Valid at fold-3 epoch-159: mse-0.266927, rmse-0.516649, ci--1, r2-0.620432, pearson-0.796588, spearman-0.743547
Traing Log at fold-3 epoch-160: mse-0.033672, rmse-0.183498, r2-0.953734
Valid at fold-3: mse-0.271673
Traing Log at fold-3 epoch-161: mse-0.032623, rmse-0.180618, r2-0.955355
Valid at fold-3: mse-0.268536
Traing Log at fold-3 epoch-162: mse-0.032802, rmse-0.181113, r2-0.955038
Valid at fold-3: mse-0.272115
Traing Log at fold-3 epoch-163: mse-0.032305, rmse-0.179735, r2-0.955758
Valid at fold-3: mse-0.270806
Traing Log at fold-3 epoch-164: mse-0.032652, rmse-0.180698, r2-0.955285
Valid at fold-3: mse-0.265937
Update best_mse, Valid at fold-3 epoch-164: mse-0.265937, rmse-0.51569, ci--1, r2-0.62184, pearson-0.792835, spearman-0.738898
Traing Log at fold-3 epoch-165: mse-0.032103, rmse-0.179172, r2-0.955978
Valid at fold-3: mse-0.267077
Traing Log at fold-3 epoch-166: mse-0.031608, rmse-0.177785, r2-0.956776
Valid at fold-3: mse-0.271827
Traing Log at fold-3 epoch-167: mse-0.031037, rmse-0.176174, r2-0.957592
Valid at fold-3: mse-0.268902
Traing Log at fold-3 epoch-168: mse-0.031182, rmse-0.176584, r2-0.957332
Valid at fold-3: mse-0.272375
Traing Log at fold-3 epoch-169: mse-0.030979, rmse-0.17601, r2-0.957608
Valid at fold-3: mse-0.267589
Traing Log at fold-3 epoch-170: mse-0.030786, rmse-0.17546, r2-0.957974
Valid at fold-3: mse-0.271752
Traing Log at fold-3 epoch-171: mse-0.030343, rmse-0.174191, r2-0.958564
Valid at fold-3: mse-0.272362
Traing Log at fold-3 epoch-172: mse-0.030635, rmse-0.175029, r2-0.958065
Valid at fold-3: mse-0.265866
Update best_mse, Valid at fold-3 epoch-172: mse-0.265866, rmse-0.515622, ci--1, r2-0.621941, pearson-0.798102, spearman-0.744643
Traing Log at fold-3 epoch-173: mse-0.030951, rmse-0.17593, r2-0.957744
Valid at fold-3: mse-0.27027
Traing Log at fold-3 epoch-174: mse-0.030231, rmse-0.173869, r2-0.958683
Valid at fold-3: mse-0.268985
Traing Log at fold-3 epoch-175: mse-0.030248, rmse-0.173919, r2-0.958623
Valid at fold-3: mse-0.270257
Traing Log at fold-3 epoch-176: mse-0.029601, rmse-0.172049, r2-0.959651
Valid at fold-3: mse-0.268359
Traing Log at fold-3 epoch-177: mse-0.029063, rmse-0.170478, r2-0.960346
Valid at fold-3: mse-0.268357
Traing Log at fold-3 epoch-178: mse-0.029682, rmse-0.172284, r2-0.959506
Valid at fold-3: mse-0.269864
Traing Log at fold-3 epoch-179: mse-0.028762, rmse-0.169594, r2-0.960757
Valid at fold-3: mse-0.264944
Update best_mse, Valid at fold-3 epoch-179: mse-0.264944, rmse-0.514727, ci--1, r2-0.623252, pearson-0.797144, spearman-0.744818
Traing Log at fold-3 epoch-180: mse-0.028641, rmse-0.169236, r2-0.960907
Valid at fold-3: mse-0.273801
Traing Log at fold-3 epoch-181: mse-0.028509, rmse-0.168845, r2-0.961161
Valid at fold-3: mse-0.271191
Traing Log at fold-3 epoch-182: mse-0.028568, rmse-0.169021, r2-0.961096
Valid at fold-3: mse-0.264164
Update best_mse, Valid at fold-3 epoch-182: mse-0.264164, rmse-0.513969, ci--1, r2-0.62436, pearson-0.796568, spearman-0.744741
Traing Log at fold-3 epoch-183: mse-0.028274, rmse-0.168148, r2-0.96142
Valid at fold-3: mse-0.270809
Traing Log at fold-3 epoch-184: mse-0.028188, rmse-0.167892, r2-0.9616
Valid at fold-3: mse-0.270806
Traing Log at fold-3 epoch-185: mse-0.027895, rmse-0.167018, r2-0.961993
Valid at fold-3: mse-0.26468
Traing Log at fold-3 epoch-186: mse-0.02737, rmse-0.165439, r2-0.962769
Valid at fold-3: mse-0.266408
Traing Log at fold-3 epoch-187: mse-0.027562, rmse-0.16602, r2-0.962491
Valid at fold-3: mse-0.272822
Traing Log at fold-3 epoch-188: mse-0.027723, rmse-0.166501, r2-0.96224
Valid at fold-3: mse-0.264931
Traing Log at fold-3 epoch-189: mse-0.027488, rmse-0.165796, r2-0.962652
Valid at fold-3: mse-0.262802
Update best_mse, Valid at fold-3 epoch-189: mse-0.262802, rmse-0.512643, ci--1, r2-0.626297, pearson-0.796191, spearman-0.748541
Traing Log at fold-3 epoch-190: mse-0.027131, rmse-0.164715, r2-0.963055
Valid at fold-3: mse-0.264228
Traing Log at fold-3 epoch-191: mse-0.027119, rmse-0.164677, r2-0.963102
Valid at fold-3: mse-0.266337
Traing Log at fold-3 epoch-192: mse-0.026719, rmse-0.163458, r2-0.963659
Valid at fold-3: mse-0.266074
Traing Log at fold-3 epoch-193: mse-0.026876, rmse-0.16394, r2-0.963484
Valid at fold-3: mse-0.267632
Traing Log at fold-3 epoch-194: mse-0.026712, rmse-0.163438, r2-0.96364
Valid at fold-3: mse-0.26245
Update best_mse, Valid at fold-3 epoch-194: mse-0.26245, rmse-0.512299, ci--1, r2-0.626797, pearson-0.798441, spearman-0.747254
Traing Log at fold-3 epoch-195: mse-0.026257, rmse-0.16204, r2-0.964319
Valid at fold-3: mse-0.264485
Traing Log at fold-3 epoch-196: mse-0.025816, rmse-0.160673, r2-0.964904
Valid at fold-3: mse-0.264065
Traing Log at fold-3 epoch-197: mse-0.025805, rmse-0.16064, r2-0.964986
Valid at fold-3: mse-0.260105
Update best_mse, Valid at fold-3 epoch-197: mse-0.260105, rmse-0.510005, ci--1, r2-0.630132, pearson-0.798564, spearman-0.747125
Traing Log at fold-3 epoch-198: mse-0.025613, rmse-0.160041, r2-0.965232
Valid at fold-3: mse-0.265682
Traing Log at fold-3 epoch-199: mse-0.025496, rmse-0.159675, r2-0.96534
Valid at fold-3: mse-0.265596
Traing Log at fold-3 epoch-200: mse-0.025121, rmse-0.158496, r2-0.965928
Valid at fold-3: mse-0.268477
Save log over at ./log/Nov13_07-15-49-kiba-novel-pair-fold3.csv

============================================================
Testing fold 3 with best model...
============================================================
/home/minhtrin/.conda/envs/LLMDTA/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:144: FutureWarning: `torch.nn.utils.weight_norm` is deprecated in favor of `torch.nn.utils.parametrizations.weight_norm`.
  WeightNorm.apply(module, name, dim)
Test at fold-3, mse: 0.484051, rmse: 0.695738, ci: 0.648081, r2: 0.19774, pearson: 0.486031, spearman: 0.410879

Fold 3 results saved to: ./log/Test-kiba-novel-pair-fold3-Nov13_07-15-49.csv
============================================================
Training fold 3 completed successfully!
============================================================
wandb: updating run metadata
wandb: uploading output.log; uploading wandb-summary.json
wandb: uploading history steps 443-443, summary, console lines 458-463
wandb: 
wandb: Run history:
wandb:      best_valid/mse â–ˆâ–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb:  best_valid/pearson â–â–ƒâ–…â–…â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:       best_valid/r2 â–â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:     best_valid/rmse â–ˆâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb: best_valid/spearman â–â–ƒâ–„â–…â–†â–†â–†â–†â–‡â–†â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:               epoch â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–†â–†â–†â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:             test/ci â–
wandb:            test/mse â–
wandb:        test/pearson â–
wandb:             test/r2 â–
wandb:                 +13 ...
wandb: 
wandb: Run summary:
wandb:      best_valid/mse 0.2601
wandb:  best_valid/pearson 0.79856
wandb:       best_valid/r2 0.63013
wandb:     best_valid/rmse 0.51001
wandb: best_valid/spearman 0.74713
wandb:               epoch 200
wandb:       final_test_ci 0.64808
wandb:      final_test_mse 0.48405
wandb:  final_test_pearson 0.48603
wandb:       final_test_r2 0.19774
wandb:                 +19 ...
wandb: 
wandb: ğŸš€ View run kiba-novel-pair-fold3 at: https://wandb.ai/tringuyen/LLMDTA/runs/jz0z4f9g
wandb: â­ï¸ View project at: https://wandb.ai/tringuyen/LLMDTA
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251113_071550-jz0z4f9g/logs
Weights & Biases run finished

Training for fold 3 completed successfully.
Python script exit code: 0
==========================================
End Time: Fri Nov 14 05:12:20 PM AEDT 2025
==========================================
