==========================================
Job ID: 2013131
Array Task ID: 3
Node: v100-f-12
Start Time: Thu Nov 13 11:35:33 AM AEDT 2025
==========================================
Activating conda environment...
Conda environment activated: LLMDTA
Checking GPU...
Thu Nov 13 11:35:34 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 565.57.01              Driver Version: 565.57.01      CUDA Version: 12.7     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-SXM2-32GB           On  |   00000000:3B:00.0 Off |                    0 |
| N/A   35C    P0             52W /  300W |       1MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Setting environment variables...

Starting training for fold 3...


============================================================
Starting training for Fold 3
Dataset: metz, Running Set: novel-pair
Epochs: 200, Batch Size: 16
============================================================

Executing: python -u code/train.py --fold 3 --cuda 0 --dataset metz --running_set novel-pair --epochs 200 --batch_size 16 --wandb_project LLMDTA
============================================================
Training Fold 3/4
Dataset: metz-novel-pair
Device: cuda (CUDA_VISIBLE_DEVICES=0)
Pretrain-./data/metz/metz_drug_pretrain.pkl
Pretrain-./data/metz/metz_esm_pretrain.pkl
============================================================
wandb: Currently logged in as: tringuyen to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: WARNING Using a boolean value for 'reinit' is deprecated. Use 'return_previous' or 'finish_previous' instead.
wandb: setting up run upjwr02n
wandb: Tracking run with wandb version 0.23.0
wandb: Run data is saved locally in /vast/minhtrin/DTA/Temp/wandb/run-20251113_113539-upjwr02n
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run metz-novel-pair-fold3
wandb: â­ï¸ View project at https://wandb.ai/tringuyen/LLMDTA
wandb: ğŸš€ View run at https://wandb.ai/tringuyen/LLMDTA/runs/upjwr02n
Weights & Biases initialized: LLMDTA
Loading fold 3 data...
  Train: ./data/dta-5fold-dataset/metz/novel-pair/fold_3_train.csv
  Valid: ./data/dta-5fold-dataset/metz/novel-pair/fold_3_valid.csv
  Test:  ./data/dta-5fold-dataset/metz/novel-pair/fold_3_test.csv
Dataset loaded: 12567 train, 16996 valid, 5696 test samples
/home/minhtrin/.conda/envs/LLMDTA/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:144: FutureWarning: `torch.nn.utils.weight_norm` is deprecated in favor of `torch.nn.utils.parametrizations.weight_norm`.
  WeightNorm.apply(module, name, dim)
Traing Log at fold-3 epoch-1: mse-2.889131, rmse-1.699744, r2--0.205666
Valid at fold-3: mse-4.585827
Update best_mse, Valid at fold-3 epoch-1: mse-4.585827, rmse-2.141454, ci--1, r2--3.956354, pearson-0.139544, spearman-0.110416
Traing Log at fold-3 epoch-2: mse-0.926172, rmse-0.962378, r2--0.18641
Valid at fold-3: mse-1.472154
Update best_mse, Valid at fold-3 epoch-2: mse-1.472154, rmse-1.213324, ci--1, r2--0.591102, pearson-0.513668, spearman-0.4663
Traing Log at fold-3 epoch-3: mse-0.76586, rmse-0.875134, r2--0.129045
Valid at fold-3: mse-1.335176
Update best_mse, Valid at fold-3 epoch-3: mse-1.335176, rmse-1.155498, ci--1, r2--0.443056, pearson-0.499369, spearman-0.447539
Traing Log at fold-3 epoch-4: mse-0.639295, rmse-0.799559, r2--0.042611
Valid at fold-3: mse-0.735332
Update best_mse, Valid at fold-3 epoch-4: mse-0.735332, rmse-0.857515, ci--1, r2-0.205254, pearson-0.537083, spearman-0.497948
Traing Log at fold-3 epoch-5: mse-0.598642, rmse-0.773719, r2-0.015041
Valid at fold-3: mse-0.903961
Traing Log at fold-3 epoch-6: mse-0.528589, rmse-0.727042, r2-0.083873
Valid at fold-3: mse-0.600436
Update best_mse, Valid at fold-3 epoch-6: mse-0.600436, rmse-0.774878, ci--1, r2-0.35105, pearson-0.606541, spearman-0.556255
Traing Log at fold-3 epoch-7: mse-0.49186, rmse-0.701328, r2-0.138841
Valid at fold-3: mse-0.850834
Traing Log at fold-3 epoch-8: mse-0.452501, rmse-0.672682, r2-0.200712
Valid at fold-3: mse-0.541011
Update best_mse, Valid at fold-3 epoch-8: mse-0.541011, rmse-0.735535, ci--1, r2-0.415276, pearson-0.647011, spearman-0.589318
Traing Log at fold-3 epoch-9: mse-0.425535, rmse-0.65233, r2-0.232596
Valid at fold-3: mse-0.568754
Traing Log at fold-3 epoch-10: mse-0.406957, rmse-0.637932, r2-0.269388
Valid at fold-3: mse-0.537149
Update best_mse, Valid at fold-3 epoch-10: mse-0.537149, rmse-0.732904, ci--1, r2-0.419451, pearson-0.64919, spearman-0.601231
Traing Log at fold-3 epoch-11: mse-0.38851, rmse-0.623306, r2-0.299835
Valid at fold-3: mse-0.535561
Update best_mse, Valid at fold-3 epoch-11: mse-0.535561, rmse-0.73182, ci--1, r2-0.421167, pearson-0.669895, spearman-0.617187
Traing Log at fold-3 epoch-12: mse-0.368767, rmse-0.607261, r2-0.346282
Valid at fold-3: mse-0.497961
Update best_mse, Valid at fold-3 epoch-12: mse-0.497961, rmse-0.705664, ci--1, r2-0.461804, pearson-0.680946, spearman-0.625017
Traing Log at fold-3 epoch-13: mse-0.350776, rmse-0.592264, r2-0.385475
Valid at fold-3: mse-0.503829
Traing Log at fold-3 epoch-14: mse-0.340181, rmse-0.58325, r2-0.409596
Valid at fold-3: mse-0.486826
Update best_mse, Valid at fold-3 epoch-14: mse-0.486826, rmse-0.697729, ci--1, r2-0.473839, pearson-0.691169, spearman-0.637377
Traing Log at fold-3 epoch-15: mse-0.329534, rmse-0.574051, r2-0.431563
Valid at fold-3: mse-0.480849
Update best_mse, Valid at fold-3 epoch-15: mse-0.480849, rmse-0.693433, ci--1, r2-0.480299, pearson-0.697591, spearman-0.645535
Traing Log at fold-3 epoch-16: mse-0.315794, rmse-0.561956, r2-0.462269
Valid at fold-3: mse-0.487173
Traing Log at fold-3 epoch-17: mse-0.302769, rmse-0.550244, r2-0.496446
Valid at fold-3: mse-0.492679
Traing Log at fold-3 epoch-18: mse-0.29266, rmse-0.54098, r2-0.518613
Valid at fold-3: mse-0.475552
Update best_mse, Valid at fold-3 epoch-18: mse-0.475552, rmse-0.689603, ci--1, r2-0.486024, pearson-0.703953, spearman-0.65696
Traing Log at fold-3 epoch-19: mse-0.282552, rmse-0.531556, r2-0.543317
Valid at fold-3: mse-0.48375
Traing Log at fold-3 epoch-20: mse-0.275437, rmse-0.52482, r2-0.556923
Valid at fold-3: mse-0.482709
Traing Log at fold-3 epoch-21: mse-0.266853, rmse-0.516578, r2-0.575266
Valid at fold-3: mse-0.457485
Update best_mse, Valid at fold-3 epoch-21: mse-0.457485, rmse-0.676376, ci--1, r2-0.505551, pearson-0.713982, spearman-0.667109
Traing Log at fold-3 epoch-22: mse-0.261102, rmse-0.510981, r2-0.589357
Valid at fold-3: mse-0.479825
Traing Log at fold-3 epoch-23: mse-0.252355, rmse-0.502349, r2-0.606034
Valid at fold-3: mse-0.45488
Update best_mse, Valid at fold-3 epoch-23: mse-0.45488, rmse-0.674448, ci--1, r2-0.508367, pearson-0.7249, spearman-0.67932
Traing Log at fold-3 epoch-24: mse-0.244961, rmse-0.494936, r2-0.622304
Valid at fold-3: mse-0.469832
Traing Log at fold-3 epoch-25: mse-0.240255, rmse-0.490158, r2-0.630385
Valid at fold-3: mse-0.438619
Update best_mse, Valid at fold-3 epoch-25: mse-0.438619, rmse-0.662283, ci--1, r2-0.525941, pearson-0.726275, spearman-0.680925
Traing Log at fold-3 epoch-26: mse-0.229902, rmse-0.479481, r2-0.653405
Valid at fold-3: mse-0.450576
Traing Log at fold-3 epoch-27: mse-0.220733, rmse-0.469823, r2-0.670614
Valid at fold-3: mse-0.455747
Traing Log at fold-3 epoch-28: mse-0.217831, rmse-0.466724, r2-0.675669
Valid at fold-3: mse-0.461101
Traing Log at fold-3 epoch-29: mse-0.213549, rmse-0.462114, r2-0.684139
Valid at fold-3: mse-0.451134
Traing Log at fold-3 epoch-30: mse-0.208613, rmse-0.456741, r2-0.694409
Valid at fold-3: mse-0.456084
Traing Log at fold-3 epoch-31: mse-0.200557, rmse-0.447835, r2-0.710133
Valid at fold-3: mse-0.448566
Traing Log at fold-3 epoch-32: mse-0.194326, rmse-0.440824, r2-0.721552
Valid at fold-3: mse-0.438822
Traing Log at fold-3 epoch-33: mse-0.194309, rmse-0.440805, r2-0.719708
Valid at fold-3: mse-0.439251
Traing Log at fold-3 epoch-34: mse-0.188588, rmse-0.434267, r2-0.731889
Valid at fold-3: mse-0.448803
Traing Log at fold-3 epoch-35: mse-0.182968, rmse-0.427748, r2-0.741927
Valid at fold-3: mse-0.440928
Traing Log at fold-3 epoch-36: mse-0.178325, rmse-0.422285, r2-0.748381
Valid at fold-3: mse-0.440523
Traing Log at fold-3 epoch-37: mse-0.173233, rmse-0.416213, r2-0.759093
Valid at fold-3: mse-0.451938
Traing Log at fold-3 epoch-38: mse-0.169759, rmse-0.412018, r2-0.765267
Valid at fold-3: mse-0.447767
Traing Log at fold-3 epoch-39: mse-0.169759, rmse-0.412018, r2-0.763612
Valid at fold-3: mse-0.437282
Update best_mse, Valid at fold-3 epoch-39: mse-0.437282, rmse-0.661273, ci--1, r2-0.527386, pearson-0.741261, spearman-0.699365
Traing Log at fold-3 epoch-40: mse-0.162825, rmse-0.403516, r2-0.776711
Valid at fold-3: mse-0.445424
Traing Log at fold-3 epoch-41: mse-0.162747, rmse-0.40342, r2-0.777206
Valid at fold-3: mse-0.440095
Traing Log at fold-3 epoch-42: mse-0.156075, rmse-0.395063, r2-0.786134
Valid at fold-3: mse-0.4333
Update best_mse, Valid at fold-3 epoch-42: mse-0.4333, rmse-0.658256, ci--1, r2-0.53169, pearson-0.73592, spearman-0.692533
Traing Log at fold-3 epoch-43: mse-0.151925, rmse-0.389776, r2-0.794323
Valid at fold-3: mse-0.442755
Traing Log at fold-3 epoch-44: mse-0.150858, rmse-0.388404, r2-0.796507
Valid at fold-3: mse-0.430929
Update best_mse, Valid at fold-3 epoch-44: mse-0.430929, rmse-0.656451, ci--1, r2-0.534253, pearson-0.743576, spearman-0.702781
Traing Log at fold-3 epoch-45: mse-0.150444, rmse-0.387871, r2-0.796697
Valid at fold-3: mse-0.42696
Update best_mse, Valid at fold-3 epoch-45: mse-0.42696, rmse-0.653422, ci--1, r2-0.538542, pearson-0.743257, spearman-0.705845
Traing Log at fold-3 epoch-46: mse-0.145122, rmse-0.380948, r2-0.805254
Valid at fold-3: mse-0.429553
Traing Log at fold-3 epoch-47: mse-0.140309, rmse-0.374578, r2-0.812475
Valid at fold-3: mse-0.424111
Update best_mse, Valid at fold-3 epoch-47: mse-0.424111, rmse-0.651238, ci--1, r2-0.541621, pearson-0.745972, spearman-0.705961
Traing Log at fold-3 epoch-48: mse-0.139748, rmse-0.373829, r2-0.813834
Valid at fold-3: mse-0.442529
Traing Log at fold-3 epoch-49: mse-0.14079, rmse-0.37522, r2-0.812695
Valid at fold-3: mse-0.426833
Traing Log at fold-3 epoch-50: mse-0.130645, rmse-0.361449, r2-0.827812
Valid at fold-3: mse-0.434518
Traing Log at fold-3 epoch-51: mse-0.130355, rmse-0.361047, r2-0.828484
Valid at fold-3: mse-0.43127
Traing Log at fold-3 epoch-52: mse-0.129411, rmse-0.359738, r2-0.829861
Valid at fold-3: mse-0.423151
Update best_mse, Valid at fold-3 epoch-52: mse-0.423151, rmse-0.650501, ci--1, r2-0.542659, pearson-0.744623, spearman-0.704092
Traing Log at fold-3 epoch-53: mse-0.126482, rmse-0.355643, r2-0.833963
Valid at fold-3: mse-0.425902
Traing Log at fold-3 epoch-54: mse-0.123881, rmse-0.351967, r2-0.838955
Valid at fold-3: mse-0.424565
Traing Log at fold-3 epoch-55: mse-0.12137, rmse-0.348382, r2-0.84301
Valid at fold-3: mse-0.434015
Traing Log at fold-3 epoch-56: mse-0.116654, rmse-0.341547, r2-0.848562
Valid at fold-3: mse-0.421963
Update best_mse, Valid at fold-3 epoch-56: mse-0.421963, rmse-0.649587, ci--1, r2-0.543943, pearson-0.749986, spearman-0.70895
Traing Log at fold-3 epoch-57: mse-0.117096, rmse-0.342193, r2-0.848527
Valid at fold-3: mse-0.425877
Traing Log at fold-3 epoch-58: mse-0.115118, rmse-0.33929, r2-0.851878
Valid at fold-3: mse-0.421138
Update best_mse, Valid at fold-3 epoch-58: mse-0.421138, rmse-0.648951, ci--1, r2-0.544835, pearson-0.746801, spearman-0.706328
Traing Log at fold-3 epoch-59: mse-0.114033, rmse-0.337688, r2-0.853597
Valid at fold-3: mse-0.429994
Traing Log at fold-3 epoch-60: mse-0.112741, rmse-0.335769, r2-0.855163
Valid at fold-3: mse-0.454149
Traing Log at fold-3 epoch-61: mse-0.110364, rmse-0.332211, r2-0.858267
Valid at fold-3: mse-0.421321
Traing Log at fold-3 epoch-62: mse-0.110036, rmse-0.331717, r2-0.85936
Valid at fold-3: mse-0.44186
Traing Log at fold-3 epoch-63: mse-0.105891, rmse-0.325409, r2-0.864875
Valid at fold-3: mse-0.427562
Traing Log at fold-3 epoch-64: mse-0.105102, rmse-0.324195, r2-0.866275
Valid at fold-3: mse-0.428054
Traing Log at fold-3 epoch-65: mse-0.101773, rmse-0.319018, r2-0.87048
Valid at fold-3: mse-0.411468
Update best_mse, Valid at fold-3 epoch-65: mse-0.411468, rmse-0.641458, ci--1, r2-0.555286, pearson-0.754378, spearman-0.71397
Traing Log at fold-3 epoch-66: mse-0.099179, rmse-0.314928, r2-0.874989
Valid at fold-3: mse-0.426098
Traing Log at fold-3 epoch-67: mse-0.100559, rmse-0.31711, r2-0.872647
Valid at fold-3: mse-0.414024
Traing Log at fold-3 epoch-68: mse-0.097946, rmse-0.312963, r2-0.876595
Valid at fold-3: mse-0.423637
Traing Log at fold-3 epoch-69: mse-0.09623, rmse-0.31021, r2-0.879171
Valid at fold-3: mse-0.42646
Traing Log at fold-3 epoch-70: mse-0.096211, rmse-0.310178, r2-0.87889
Valid at fold-3: mse-0.420707
Traing Log at fold-3 epoch-71: mse-0.094157, rmse-0.30685, r2-0.88198
Valid at fold-3: mse-0.422694
Traing Log at fold-3 epoch-72: mse-0.09409, rmse-0.306741, r2-0.882266
Valid at fold-3: mse-0.426165
Traing Log at fold-3 epoch-73: mse-0.091574, rmse-0.302612, r2-0.88526
Valid at fold-3: mse-0.432374
Traing Log at fold-3 epoch-74: mse-0.091201, rmse-0.301995, r2-0.88616
Valid at fold-3: mse-0.4129
Traing Log at fold-3 epoch-75: mse-0.086668, rmse-0.294395, r2-0.892097
Valid at fold-3: mse-0.423203
Traing Log at fold-3 epoch-76: mse-0.087018, rmse-0.294988, r2-0.892225
Valid at fold-3: mse-0.42154
Traing Log at fold-3 epoch-77: mse-0.086065, rmse-0.293369, r2-0.893032
Valid at fold-3: mse-0.420726
Traing Log at fold-3 epoch-78: mse-0.084531, rmse-0.290742, r2-0.894952
Valid at fold-3: mse-0.41802
Traing Log at fold-3 epoch-79: mse-0.085922, rmse-0.293125, r2-0.893599
Valid at fold-3: mse-0.413405
Traing Log at fold-3 epoch-80: mse-0.084356, rmse-0.29044, r2-0.895729
Valid at fold-3: mse-0.423303
Traing Log at fold-3 epoch-81: mse-0.083827, rmse-0.289529, r2-0.896533
Valid at fold-3: mse-0.419042
Traing Log at fold-3 epoch-82: mse-0.081406, rmse-0.285317, r2-0.899218
Valid at fold-3: mse-0.412995
Traing Log at fold-3 epoch-83: mse-0.081809, rmse-0.286023, r2-0.898831
Valid at fold-3: mse-0.416601
Traing Log at fold-3 epoch-84: mse-0.079468, rmse-0.281901, r2-0.902154
Valid at fold-3: mse-0.423312
Traing Log at fold-3 epoch-85: mse-0.080914, rmse-0.284454, r2-0.900385
Valid at fold-3: mse-0.406743
Update best_mse, Valid at fold-3 epoch-85: mse-0.406743, rmse-0.637764, ci--1, r2-0.560393, pearson-0.758499, spearman-0.719956
Traing Log at fold-3 epoch-86: mse-0.077136, rmse-0.277733, r2-0.905451
Valid at fold-3: mse-0.415163
Traing Log at fold-3 epoch-87: mse-0.076401, rmse-0.276407, r2-0.906213
Valid at fold-3: mse-0.43647
Traing Log at fold-3 epoch-88: mse-0.077736, rmse-0.278813, r2-0.904423
Valid at fold-3: mse-0.41415
Traing Log at fold-3 epoch-89: mse-0.078211, rmse-0.279662, r2-0.904179
Valid at fold-3: mse-0.417467
Traing Log at fold-3 epoch-90: mse-0.074655, rmse-0.273231, r2-0.90828
Valid at fold-3: mse-0.407577
Traing Log at fold-3 epoch-91: mse-0.072259, rmse-0.268811, r2-0.911854
Valid at fold-3: mse-0.422429
Traing Log at fold-3 epoch-92: mse-0.073582, rmse-0.271259, r2-0.910031
Valid at fold-3: mse-0.410254
Traing Log at fold-3 epoch-93: mse-0.072723, rmse-0.269672, r2-0.91125
Valid at fold-3: mse-0.433879
Traing Log at fold-3 epoch-94: mse-0.071159, rmse-0.266757, r2-0.913101
Valid at fold-3: mse-0.414004
Traing Log at fold-3 epoch-95: mse-0.071463, rmse-0.267325, r2-0.912945
Valid at fold-3: mse-0.414427
Traing Log at fold-3 epoch-96: mse-0.070886, rmse-0.266244, r2-0.913614
Valid at fold-3: mse-0.412753
Traing Log at fold-3 epoch-97: mse-0.068706, rmse-0.262119, r2-0.916714
Valid at fold-3: mse-0.420799
Traing Log at fold-3 epoch-98: mse-0.070213, rmse-0.264978, r2-0.914334
Valid at fold-3: mse-0.405657
Update best_mse, Valid at fold-3 epoch-98: mse-0.405657, rmse-0.636912, ci--1, r2-0.561567, pearson-0.758822, spearman-0.721056
Traing Log at fold-3 epoch-99: mse-0.069331, rmse-0.263307, r2-0.915808
Valid at fold-3: mse-0.422548
Traing Log at fold-3 epoch-100: mse-0.06668, rmse-0.258225, r2-0.91928
Valid at fold-3: mse-0.417479
Traing Log at fold-3 epoch-101: mse-0.066129, rmse-0.257157, r2-0.920035
Valid at fold-3: mse-0.419029
Traing Log at fold-3 epoch-102: mse-0.067194, rmse-0.259218, r2-0.918206
Valid at fold-3: mse-0.408557
Traing Log at fold-3 epoch-103: mse-0.066753, rmse-0.258367, r2-0.91917
Valid at fold-3: mse-0.413121
Traing Log at fold-3 epoch-104: mse-0.066536, rmse-0.257945, r2-0.919708
Valid at fold-3: mse-0.411961
Traing Log at fold-3 epoch-105: mse-0.066386, rmse-0.257655, r2-0.919326
Valid at fold-3: mse-0.408487
Traing Log at fold-3 epoch-106: mse-0.065182, rmse-0.255308, r2-0.921199
Valid at fold-3: mse-0.425964
Traing Log at fold-3 epoch-107: mse-0.064783, rmse-0.254526, r2-0.921467
Valid at fold-3: mse-0.412358
Traing Log at fold-3 epoch-108: mse-0.061453, rmse-0.247898, r2-0.926034
Valid at fold-3: mse-0.411199
Traing Log at fold-3 epoch-109: mse-0.06392, rmse-0.252823, r2-0.922988
Valid at fold-3: mse-0.408983
Traing Log at fold-3 epoch-110: mse-0.061647, rmse-0.248287, r2-0.925622
Valid at fold-3: mse-0.40178
Update best_mse, Valid at fold-3 epoch-110: mse-0.40178, rmse-0.633861, ci--1, r2-0.565757, pearson-0.758695, spearman-0.725515
Traing Log at fold-3 epoch-111: mse-0.061977, rmse-0.248952, r2-0.925232
Valid at fold-3: mse-0.415121
Traing Log at fold-3 epoch-112: mse-0.062155, rmse-0.24931, r2-0.925176
Valid at fold-3: mse-0.408527
Traing Log at fold-3 epoch-113: mse-0.060389, rmse-0.245742, r2-0.927326
Valid at fold-3: mse-0.413172
Traing Log at fold-3 epoch-114: mse-0.059954, rmse-0.244856, r2-0.928025
Valid at fold-3: mse-0.408485
Traing Log at fold-3 epoch-115: mse-0.058592, rmse-0.242058, r2-0.929653
Valid at fold-3: mse-0.407315
Traing Log at fold-3 epoch-116: mse-0.05961, rmse-0.244152, r2-0.928325
Valid at fold-3: mse-0.408166
Traing Log at fold-3 epoch-117: mse-0.057748, rmse-0.240307, r2-0.930925
Valid at fold-3: mse-0.409869
Traing Log at fold-3 epoch-118: mse-0.057648, rmse-0.2401, r2-0.930917
Valid at fold-3: mse-0.420539
Traing Log at fold-3 epoch-119: mse-0.058868, rmse-0.242627, r2-0.928954
Valid at fold-3: mse-0.42308
Traing Log at fold-3 epoch-120: mse-0.057275, rmse-0.239323, r2-0.931448
Valid at fold-3: mse-0.407169
Traing Log at fold-3 epoch-121: mse-0.057924, rmse-0.240675, r2-0.930495
Valid at fold-3: mse-0.399481
Update best_mse, Valid at fold-3 epoch-121: mse-0.399481, rmse-0.632045, ci--1, r2-0.568242, pearson-0.76148, spearman-0.726425
Traing Log at fold-3 epoch-122: mse-0.055559, rmse-0.23571, r2-0.933349
Valid at fold-3: mse-0.397238
Update best_mse, Valid at fold-3 epoch-122: mse-0.397238, rmse-0.630268, ci--1, r2-0.570666, pearson-0.762587, spearman-0.724755
Traing Log at fold-3 epoch-123: mse-0.055721, rmse-0.236053, r2-0.933447
Valid at fold-3: mse-0.400299
Traing Log at fold-3 epoch-124: mse-0.055016, rmse-0.234555, r2-0.934336
Valid at fold-3: mse-0.401964
Traing Log at fold-3 epoch-125: mse-0.056163, rmse-0.236988, r2-0.93269
Valid at fold-3: mse-0.412258
Traing Log at fold-3 epoch-126: mse-0.056292, rmse-0.237259, r2-0.932538
Valid at fold-3: mse-0.39876
Traing Log at fold-3 epoch-127: mse-0.052616, rmse-0.229382, r2-0.937503
Valid at fold-3: mse-0.401242
Traing Log at fold-3 epoch-128: mse-0.053117, rmse-0.230471, r2-0.936542
Valid at fold-3: mse-0.396645
Update best_mse, Valid at fold-3 epoch-128: mse-0.396645, rmse-0.629797, ci--1, r2-0.571307, pearson-0.758972, spearman-0.72382
Traing Log at fold-3 epoch-129: mse-0.053631, rmse-0.231583, r2-0.935991
Valid at fold-3: mse-0.404283
Traing Log at fold-3 epoch-130: mse-0.053212, rmse-0.230678, r2-0.93652
Valid at fold-3: mse-0.403782
Traing Log at fold-3 epoch-131: mse-0.05308, rmse-0.230392, r2-0.936872
Valid at fold-3: mse-0.405545
Traing Log at fold-3 epoch-132: mse-0.052019, rmse-0.228078, r2-0.937901
Valid at fold-3: mse-0.398592
Traing Log at fold-3 epoch-133: mse-0.051579, rmse-0.22711, r2-0.938553
Valid at fold-3: mse-0.404236
Traing Log at fold-3 epoch-134: mse-0.051659, rmse-0.227286, r2-0.938642
Valid at fold-3: mse-0.406971
Traing Log at fold-3 epoch-135: mse-0.051134, rmse-0.226129, r2-0.939187
Valid at fold-3: mse-0.406833
Traing Log at fold-3 epoch-136: mse-0.052322, rmse-0.22874, r2-0.93754
Valid at fold-3: mse-0.399305
Traing Log at fold-3 epoch-137: mse-0.051935, rmse-0.227893, r2-0.938023
Valid at fold-3: mse-0.41689
Traing Log at fold-3 epoch-138: mse-0.050442, rmse-0.224593, r2-0.940088
Valid at fold-3: mse-0.400649
Traing Log at fold-3 epoch-139: mse-0.050754, rmse-0.225286, r2-0.939634
Valid at fold-3: mse-0.40258
Traing Log at fold-3 epoch-140: mse-0.049645, rmse-0.222811, r2-0.940973
Valid at fold-3: mse-0.406445
Traing Log at fold-3 epoch-141: mse-0.049346, rmse-0.222139, r2-0.941399
Valid at fold-3: mse-0.406256
Traing Log at fold-3 epoch-142: mse-0.049144, rmse-0.221684, r2-0.941753
Valid at fold-3: mse-0.400131
Traing Log at fold-3 epoch-143: mse-0.049073, rmse-0.221525, r2-0.941661
Valid at fold-3: mse-0.39234
Update best_mse, Valid at fold-3 epoch-143: mse-0.39234, rmse-0.62637, ci--1, r2-0.57596, pearson-0.764187, spearman-0.728691
Traing Log at fold-3 epoch-144: mse-0.049268, rmse-0.221963, r2-0.941526
Valid at fold-3: mse-0.392028
Update best_mse, Valid at fold-3 epoch-144: mse-0.392028, rmse-0.626121, ci--1, r2-0.576297, pearson-0.764986, spearman-0.729832
Traing Log at fold-3 epoch-145: mse-0.04803, rmse-0.219158, r2-0.943137
Valid at fold-3: mse-0.401653
Traing Log at fold-3 epoch-146: mse-0.049382, rmse-0.22222, r2-0.94119
Valid at fold-3: mse-0.403587
Traing Log at fold-3 epoch-147: mse-0.048302, rmse-0.219776, r2-0.942794
Valid at fold-3: mse-0.40442
Traing Log at fold-3 epoch-148: mse-0.046083, rmse-0.214669, r2-0.945493
Valid at fold-3: mse-0.405802
Traing Log at fold-3 epoch-149: mse-0.047287, rmse-0.217457, r2-0.944037
Valid at fold-3: mse-0.405652
Traing Log at fold-3 epoch-150: mse-0.046388, rmse-0.21538, r2-0.9451
Valid at fold-3: mse-0.39776
Traing Log at fold-3 epoch-151: mse-0.046324, rmse-0.21523, r2-0.945112
Valid at fold-3: mse-0.40135
Traing Log at fold-3 epoch-152: mse-0.045194, rmse-0.212589, r2-0.946661
Valid at fold-3: mse-0.395681
Traing Log at fold-3 epoch-153: mse-0.047049, rmse-0.216908, r2-0.944286
Valid at fold-3: mse-0.390755
Update best_mse, Valid at fold-3 epoch-153: mse-0.390755, rmse-0.625104, ci--1, r2-0.577673, pearson-0.76533, spearman-0.731662
Traing Log at fold-3 epoch-154: mse-0.045824, rmse-0.214066, r2-0.945827
Valid at fold-3: mse-0.396428
Traing Log at fold-3 epoch-155: mse-0.045507, rmse-0.213323, r2-0.94629
Valid at fold-3: mse-0.397732
Traing Log at fold-3 epoch-156: mse-0.045104, rmse-0.212378, r2-0.946692
Valid at fold-3: mse-0.393567
Traing Log at fold-3 epoch-157: mse-0.045411, rmse-0.213098, r2-0.946276
Valid at fold-3: mse-0.402324
Traing Log at fold-3 epoch-158: mse-0.044976, rmse-0.212075, r2-0.946884
Valid at fold-3: mse-0.399613
Traing Log at fold-3 epoch-159: mse-0.045368, rmse-0.212998, r2-0.946368
Valid at fold-3: mse-0.389679
Update best_mse, Valid at fold-3 epoch-159: mse-0.389679, rmse-0.624243, ci--1, r2-0.578835, pearson-0.764867, spearman-0.731012
Traing Log at fold-3 epoch-160: mse-0.044725, rmse-0.211482, r2-0.947133
Valid at fold-3: mse-0.397094
Traing Log at fold-3 epoch-161: mse-0.043305, rmse-0.2081, r2-0.948879
Valid at fold-3: mse-0.393153
Traing Log at fold-3 epoch-162: mse-0.04391, rmse-0.209547, r2-0.948282
Valid at fold-3: mse-0.409036
Traing Log at fold-3 epoch-163: mse-0.043556, rmse-0.2087, r2-0.948522
Valid at fold-3: mse-0.399192
Traing Log at fold-3 epoch-164: mse-0.043801, rmse-0.209287, r2-0.948339
Valid at fold-3: mse-0.405771
Traing Log at fold-3 epoch-165: mse-0.042743, rmse-0.206745, r2-0.949621
Valid at fold-3: mse-0.391724
Traing Log at fold-3 epoch-166: mse-0.041625, rmse-0.204021, r2-0.950959
Valid at fold-3: mse-0.393362
Traing Log at fold-3 epoch-167: mse-0.041755, rmse-0.204339, r2-0.950956
Valid at fold-3: mse-0.392229
Traing Log at fold-3 epoch-168: mse-0.042243, rmse-0.205531, r2-0.950029
Valid at fold-3: mse-0.400011
Traing Log at fold-3 epoch-169: mse-0.042148, rmse-0.205301, r2-0.950458
Valid at fold-3: mse-0.401343
Traing Log at fold-3 epoch-170: mse-0.043582, rmse-0.208763, r2-0.948765
Valid at fold-3: mse-0.386975
Update best_mse, Valid at fold-3 epoch-170: mse-0.386975, rmse-0.622073, ci--1, r2-0.581758, pearson-0.768216, spearman-0.732908
Traing Log at fold-3 epoch-171: mse-0.042299, rmse-0.205666, r2-0.95016
Valid at fold-3: mse-0.396655
Traing Log at fold-3 epoch-172: mse-0.040925, rmse-0.202299, r2-0.951858
Valid at fold-3: mse-0.406275
Traing Log at fold-3 epoch-173: mse-0.040277, rmse-0.200691, r2-0.952674
Valid at fold-3: mse-0.395943
Traing Log at fold-3 epoch-174: mse-0.041207, rmse-0.202995, r2-0.95156
Valid at fold-3: mse-0.397121
Traing Log at fold-3 epoch-175: mse-0.041705, rmse-0.204217, r2-0.950907
Valid at fold-3: mse-0.401745
Traing Log at fold-3 epoch-176: mse-0.040064, rmse-0.200159, r2-0.952882
Valid at fold-3: mse-0.393395
Traing Log at fold-3 epoch-177: mse-0.040481, rmse-0.201199, r2-0.95234
Valid at fold-3: mse-0.393419
Traing Log at fold-3 epoch-178: mse-0.039568, rmse-0.198917, r2-0.953491
Valid at fold-3: mse-0.39254
Traing Log at fold-3 epoch-179: mse-0.040519, rmse-0.201294, r2-0.952407
Valid at fold-3: mse-0.38982
Traing Log at fold-3 epoch-180: mse-0.04003, rmse-0.200075, r2-0.953022
Valid at fold-3: mse-0.390944
Traing Log at fold-3 epoch-181: mse-0.039773, rmse-0.199433, r2-0.953295
Valid at fold-3: mse-0.387093
Traing Log at fold-3 epoch-182: mse-0.039925, rmse-0.199812, r2-0.953025
Valid at fold-3: mse-0.396778
Traing Log at fold-3 epoch-183: mse-0.03894, rmse-0.197332, r2-0.954377
Valid at fold-3: mse-0.403528
Traing Log at fold-3 epoch-184: mse-0.039017, rmse-0.197527, r2-0.954129
Valid at fold-3: mse-0.399526
Traing Log at fold-3 epoch-185: mse-0.038474, rmse-0.196147, r2-0.954922
Valid at fold-3: mse-0.402564
Traing Log at fold-3 epoch-186: mse-0.038578, rmse-0.196412, r2-0.954621
Valid at fold-3: mse-0.408299
Traing Log at fold-3 epoch-187: mse-0.037576, rmse-0.193844, r2-0.955932
Valid at fold-3: mse-0.399947
Traing Log at fold-3 epoch-188: mse-0.038664, rmse-0.196631, r2-0.954715
Valid at fold-3: mse-0.395759
Traing Log at fold-3 epoch-189: mse-0.037837, rmse-0.194517, r2-0.955588
Valid at fold-3: mse-0.396476
Traing Log at fold-3 epoch-190: mse-0.038442, rmse-0.196066, r2-0.954921
Valid at fold-3: mse-0.394633
Traing Log at fold-3 epoch-191: mse-0.038165, rmse-0.195358, r2-0.955224
Valid at fold-3: mse-0.39488
Traing stop at epoch-191, model save at-./savemodel/metz-novel-pair-fold3-Nov13_11-35-39.pth
Save log over at ./log/Nov13_11-35-39-metz-novel-pair-fold3.csv

============================================================
Testing fold 3 with best model...
============================================================
/home/minhtrin/.conda/envs/LLMDTA/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:144: FutureWarning: `torch.nn.utils.weight_norm` is deprecated in favor of `torch.nn.utils.parametrizations.weight_norm`.
  WeightNorm.apply(module, name, dim)
Test at fold-3, mse: 0.729863, rmse: 0.85432, ci: 0.653956, r2: 0.242196, pearson: 0.51119, spearman: 0.43979

Fold 3 results saved to: ./log/Test-metz-novel-pair-fold3-Nov13_11-35-39.csv
============================================================
Training fold 3 completed successfully!
============================================================
wandb: updating run metadata
wandb: uploading output.log; uploading wandb-summary.json
wandb: uploading history steps 417-417, summary, console lines 433-438
wandb: 
wandb: Run history:
wandb:      best_valid/mse â–ˆâ–ƒâ–ƒâ–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb:  best_valid/pearson â–â–…â–…â–…â–†â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:       best_valid/r2 â–â–†â–†â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:     best_valid/rmse â–ˆâ–„â–ƒâ–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb: best_valid/spearman â–â–…â–…â–…â–†â–†â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:               epoch â–â–â–â–â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–…â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–ˆ
wandb:             test/ci â–
wandb:            test/mse â–
wandb:        test/pearson â–
wandb:             test/r2 â–
wandb:                 +13 ...
wandb: 
wandb: Run summary:
wandb:      best_valid/mse 0.38698
wandb:  best_valid/pearson 0.76822
wandb:       best_valid/r2 0.58176
wandb:     best_valid/rmse 0.62207
wandb: best_valid/spearman 0.73291
wandb:               epoch 191
wandb:       final_test_ci 0.65396
wandb:      final_test_mse 0.72986
wandb:  final_test_pearson 0.51119
wandb:       final_test_r2 0.2422
wandb:                 +19 ...
wandb: 
wandb: ğŸš€ View run metz-novel-pair-fold3 at: https://wandb.ai/tringuyen/LLMDTA/runs/upjwr02n
wandb: â­ï¸ View project at: https://wandb.ai/tringuyen/LLMDTA
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251113_113539-upjwr02n/logs
Weights & Biases run finished

Training for fold 3 completed successfully.
Python script exit code: 0
==========================================
End Time: Thu Nov 13 09:12:00 PM AEDT 2025
==========================================
