==========================================
Job ID: 2013070
Array Task ID: 2
Node: v100-f-08
Start Time: Thu Nov 13 07:14:43 AM AEDT 2025
==========================================
Activating conda environment...
Conda environment activated: LLMDTA
Checking GPU...
Thu Nov 13 07:14:43 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 565.57.01              Driver Version: 565.57.01      CUDA Version: 12.7     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-SXM2-32GB           On  |   00000000:18:00.0 Off |                    0 |
| N/A   31C    P0             40W /  300W |       1MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  Tesla V100-SXM2-32GB           On  |   00000000:3B:00.0 Off |                    0 |
| N/A   29C    P0             43W /  300W |       1MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  Tesla V100-SXM2-32GB           On  |   00000000:86:00.0 Off |                    0 |
| N/A   29C    P0             43W /  300W |       1MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  Tesla V100-SXM2-32GB           On  |   00000000:AF:00.0 Off |                    0 |
| N/A   32C    P0             43W /  300W |       1MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Setting environment variables...

Starting training for fold 2...


============================================================
Starting training for Fold 2
Dataset: kiba, Running Set: novel-drug
Epochs: 200, Batch Size: 16
============================================================

Executing: python -u code/train.py --fold 2 --cuda 0 --dataset kiba --running_set novel-drug --epochs 200 --batch_size 16 --wandb_project LLMDTA
============================================================
Training Fold 2/4
Dataset: kiba-novel-drug
Device: cuda (CUDA_VISIBLE_DEVICES=0)
Pretrain-./data/kiba/kiba_drug_pretrain.pkl
Pretrain-./data/kiba/kiba_esm_pretrain.pkl
============================================================
wandb: Currently logged in as: tringuyen to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: WARNING Using a boolean value for 'reinit' is deprecated. Use 'return_previous' or 'finish_previous' instead.
wandb: setting up run 3hrz0atd
wandb: Tracking run with wandb version 0.23.0
wandb: Run data is saved locally in /vast/minhtrin/DTA/Temp/wandb/run-20251113_071503-3hrz0atd
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run kiba-novel-drug-fold2
wandb: â­ï¸ View project at https://wandb.ai/tringuyen/LLMDTA
wandb: ğŸš€ View run at https://wandb.ai/tringuyen/LLMDTA/runs/3hrz0atd
Weights & Biases initialized: LLMDTA
Loading fold 2 data...
  Train: ./data/dta-5fold-dataset/kiba/novel-drug/fold_2_train.csv
  Valid: ./data/dta-5fold-dataset/kiba/novel-drug/fold_2_valid.csv
  Test:  ./data/dta-5fold-dataset/kiba/novel-drug/fold_2_test.csv
Dataset loaded: 75622 train, 18906 valid, 23726 test samples
/home/minhtrin/.conda/envs/LLMDTA/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:144: FutureWarning: `torch.nn.utils.weight_norm` is deprecated in favor of `torch.nn.utils.parametrizations.weight_norm`.
  WeightNorm.apply(module, name, dim)
Traing Log at fold-2 epoch-1: mse-2.397689, rmse-1.548447, r2--0.161663
Valid at fold-2: mse-0.762067
Update best_mse, Valid at fold-2 epoch-1: mse-0.762067, rmse-0.872964, ci--1, r2--0.107057, pearson-0.551701, spearman-0.544571
Traing Log at fold-2 epoch-2: mse-0.484001, rmse-0.695702, r2--0.37563
Valid at fold-2: mse-0.445463
Update best_mse, Valid at fold-2 epoch-2: mse-0.445463, rmse-0.667431, ci--1, r2-0.352874, pearson-0.662091, spearman-0.626309
Traing Log at fold-2 epoch-3: mse-0.384747, rmse-0.62028, r2--0.093322
Valid at fold-2: mse-0.340767
Update best_mse, Valid at fold-2 epoch-3: mse-0.340767, rmse-0.583753, ci--1, r2-0.504966, pearson-0.714451, spearman-0.700518
Traing Log at fold-2 epoch-4: mse-0.396271, rmse-0.6295, r2-0.066216
Valid at fold-2: mse-0.314813
Update best_mse, Valid at fold-2 epoch-4: mse-0.314813, rmse-0.561082, ci--1, r2-0.54267, pearson-0.753354, spearman-0.733866
Traing Log at fold-2 epoch-5: mse-0.313798, rmse-0.560177, r2-0.219252
Valid at fold-2: mse-0.289325
Update best_mse, Valid at fold-2 epoch-5: mse-0.289325, rmse-0.537889, ci--1, r2-0.579697, pearson-0.761956, spearman-0.735162
Traing Log at fold-2 epoch-6: mse-0.306263, rmse-0.553411, r2-0.24817
Valid at fold-2: mse-0.286515
Update best_mse, Valid at fold-2 epoch-6: mse-0.286515, rmse-0.535271, ci--1, r2-0.583779, pearson-0.765447, spearman-0.75202
Traing Log at fold-2 epoch-7: mse-0.286855, rmse-0.535588, r2-0.325025
Valid at fold-2: mse-0.291826
Traing Log at fold-2 epoch-8: mse-0.271858, rmse-0.5214, r2-0.382266
Valid at fold-2: mse-0.26454
Update best_mse, Valid at fold-2 epoch-8: mse-0.26454, rmse-0.514335, ci--1, r2-0.615702, pearson-0.79328, spearman-0.770699
Traing Log at fold-2 epoch-9: mse-0.257625, rmse-0.507568, r2-0.431747
Valid at fold-2: mse-0.245322
Update best_mse, Valid at fold-2 epoch-9: mse-0.245322, rmse-0.4953, ci--1, r2-0.643619, pearson-0.802649, spearman-0.787725
Traing Log at fold-2 epoch-10: mse-0.246079, rmse-0.496063, r2-0.469971
Valid at fold-2: mse-0.246584
Traing Log at fold-2 epoch-11: mse-0.235481, rmse-0.485264, r2-0.504408
Valid at fold-2: mse-0.245995
Traing Log at fold-2 epoch-12: mse-0.227427, rmse-0.476893, r2-0.530639
Valid at fold-2: mse-0.233744
Update best_mse, Valid at fold-2 epoch-12: mse-0.233744, rmse-0.483471, ci--1, r2-0.660439, pearson-0.816657, spearman-0.797294
Traing Log at fold-2 epoch-13: mse-0.216663, rmse-0.465471, r2-0.561293
Valid at fold-2: mse-0.225962
Update best_mse, Valid at fold-2 epoch-13: mse-0.225962, rmse-0.475355, ci--1, r2-0.671744, pearson-0.825102, spearman-0.804917
Traing Log at fold-2 epoch-14: mse-0.210828, rmse-0.45916, r2-0.577397
Valid at fold-2: mse-0.231686
Traing Log at fold-2 epoch-15: mse-0.203177, rmse-0.450752, r2-0.600408
Valid at fold-2: mse-0.214596
Update best_mse, Valid at fold-2 epoch-15: mse-0.214596, rmse-0.463245, ci--1, r2-0.688256, pearson-0.832809, spearman-0.807126
Traing Log at fold-2 epoch-16: mse-0.198134, rmse-0.445123, r2-0.612882
Valid at fold-2: mse-0.215117
Traing Log at fold-2 epoch-17: mse-0.191227, rmse-0.437295, r2-0.63171
Valid at fold-2: mse-0.209606
Update best_mse, Valid at fold-2 epoch-17: mse-0.209606, rmse-0.457827, ci--1, r2-0.695505, pearson-0.841214, spearman-0.819123
Traing Log at fold-2 epoch-18: mse-0.187515, rmse-0.43303, r2-0.640901
Valid at fold-2: mse-0.212865
Traing Log at fold-2 epoch-19: mse-0.180168, rmse-0.424462, r2-0.659197
Valid at fold-2: mse-0.203066
Update best_mse, Valid at fold-2 epoch-19: mse-0.203066, rmse-0.450628, ci--1, r2-0.705006, pearson-0.842387, spearman-0.824649
Traing Log at fold-2 epoch-20: mse-0.176819, rmse-0.420499, r2-0.668384
Valid at fold-2: mse-0.21643
Traing Log at fold-2 epoch-21: mse-0.171723, rmse-0.414394, r2-0.680977
Valid at fold-2: mse-0.205424
Traing Log at fold-2 epoch-22: mse-0.168757, rmse-0.4108, r2-0.68786
Valid at fold-2: mse-0.203608
Traing Log at fold-2 epoch-23: mse-0.163625, rmse-0.404506, r2-0.700589
Valid at fold-2: mse-0.200942
Update best_mse, Valid at fold-2 epoch-23: mse-0.200942, rmse-0.448266, ci--1, r2-0.708091, pearson-0.844812, spearman-0.822042
Traing Log at fold-2 epoch-24: mse-0.160114, rmse-0.400143, r2-0.70808
Valid at fold-2: mse-0.195889
Update best_mse, Valid at fold-2 epoch-24: mse-0.195889, rmse-0.442593, ci--1, r2-0.715432, pearson-0.851807, spearman-0.827896
Traing Log at fold-2 epoch-25: mse-0.158577, rmse-0.398218, r2-0.712803
Valid at fold-2: mse-0.192313
Update best_mse, Valid at fold-2 epoch-25: mse-0.192313, rmse-0.438535, ci--1, r2-0.720626, pearson-0.851676, spearman-0.832142
Traing Log at fold-2 epoch-26: mse-0.152486, rmse-0.390495, r2-0.72627
Valid at fold-2: mse-0.193341
Traing Log at fold-2 epoch-27: mse-0.149323, rmse-0.386423, r2-0.733191
Valid at fold-2: mse-0.19565
Traing Log at fold-2 epoch-28: mse-0.146098, rmse-0.382228, r2-0.740543
Valid at fold-2: mse-0.189302
Update best_mse, Valid at fold-2 epoch-28: mse-0.189302, rmse-0.435088, ci--1, r2-0.725001, pearson-0.857752, spearman-0.835065
Traing Log at fold-2 epoch-29: mse-0.142849, rmse-0.377953, r2-0.747734
Valid at fold-2: mse-0.189225
Update best_mse, Valid at fold-2 epoch-29: mse-0.189225, rmse-0.435, ci--1, r2-0.725112, pearson-0.86066, spearman-0.834921
Traing Log at fold-2 epoch-30: mse-0.141462, rmse-0.376114, r2-0.751444
Valid at fold-2: mse-0.182606
Update best_mse, Valid at fold-2 epoch-30: mse-0.182606, rmse-0.427324, ci--1, r2-0.734728, pearson-0.86046, spearman-0.835589
Traing Log at fold-2 epoch-31: mse-0.137531, rmse-0.370851, r2-0.759381
Valid at fold-2: mse-0.185082
Traing Log at fold-2 epoch-32: mse-0.13684, rmse-0.369919, r2-0.760773
Valid at fold-2: mse-0.192769
Traing Log at fold-2 epoch-33: mse-0.131842, rmse-0.363101, r2-0.772075
Valid at fold-2: mse-0.182374
Update best_mse, Valid at fold-2 epoch-33: mse-0.182374, rmse-0.427053, ci--1, r2-0.735064, pearson-0.862756, spearman-0.838236
Traing Log at fold-2 epoch-34: mse-0.129888, rmse-0.360399, r2-0.775476
Valid at fold-2: mse-0.200316
Traing Log at fold-2 epoch-35: mse-0.128506, rmse-0.358478, r2-0.778825
Valid at fold-2: mse-0.192536
Traing Log at fold-2 epoch-36: mse-0.126089, rmse-0.35509, r2-0.78434
Valid at fold-2: mse-0.187265
Traing Log at fold-2 epoch-37: mse-0.123432, rmse-0.35133, r2-0.78933
Valid at fold-2: mse-0.185676
Traing Log at fold-2 epoch-38: mse-0.123166, rmse-0.35095, r2-0.790189
Valid at fold-2: mse-0.183859
Traing Log at fold-2 epoch-39: mse-0.118908, rmse-0.34483, r2-0.798909
Valid at fold-2: mse-0.177125
Update best_mse, Valid at fold-2 epoch-39: mse-0.177125, rmse-0.420863, ci--1, r2-0.742689, pearson-0.867023, spearman-0.841659
Traing Log at fold-2 epoch-40: mse-0.117149, rmse-0.34227, r2-0.80186
Valid at fold-2: mse-0.18145
Traing Log at fold-2 epoch-41: mse-0.114976, rmse-0.339082, r2-0.806993
Valid at fold-2: mse-0.17787
Traing Log at fold-2 epoch-42: mse-0.11385, rmse-0.337416, r2-0.808873
Valid at fold-2: mse-0.17649
Update best_mse, Valid at fold-2 epoch-42: mse-0.17649, rmse-0.420107, ci--1, r2-0.743612, pearson-0.866263, spearman-0.84067
Traing Log at fold-2 epoch-43: mse-0.112756, rmse-0.335792, r2-0.811262
Valid at fold-2: mse-0.178241
Traing Log at fold-2 epoch-44: mse-0.11024, rmse-0.332024, r2-0.815966
Valid at fold-2: mse-0.185595
Traing Log at fold-2 epoch-45: mse-0.108466, rmse-0.329343, r2-0.819709
Valid at fold-2: mse-0.172625
Update best_mse, Valid at fold-2 epoch-45: mse-0.172625, rmse-0.415481, ci--1, r2-0.749227, pearson-0.867941, spearman-0.84487
Traing Log at fold-2 epoch-46: mse-0.106728, rmse-0.326692, r2-0.823069
Valid at fold-2: mse-0.172112
Update best_mse, Valid at fold-2 epoch-46: mse-0.172112, rmse-0.414864, ci--1, r2-0.749972, pearson-0.869194, spearman-0.845114
Traing Log at fold-2 epoch-47: mse-0.104812, rmse-0.323747, r2-0.826376
Valid at fold-2: mse-0.172643
Traing Log at fold-2 epoch-48: mse-0.102597, rmse-0.320307, r2-0.830995
Valid at fold-2: mse-0.180807
Traing Log at fold-2 epoch-49: mse-0.10237, rmse-0.319954, r2-0.831377
Valid at fold-2: mse-0.183847
Traing Log at fold-2 epoch-50: mse-0.100773, rmse-0.317447, r2-0.834243
Valid at fold-2: mse-0.174664
Traing Log at fold-2 epoch-51: mse-0.098282, rmse-0.3135, r2-0.839121
Valid at fold-2: mse-0.179304
Traing Log at fold-2 epoch-52: mse-0.098584, rmse-0.313981, r2-0.839087
Valid at fold-2: mse-0.173632
Traing Log at fold-2 epoch-53: mse-0.096402, rmse-0.310487, r2-0.842639
Valid at fold-2: mse-0.170593
Update best_mse, Valid at fold-2 epoch-53: mse-0.170593, rmse-0.413029, ci--1, r2-0.752179, pearson-0.870647, spearman-0.844634
Traing Log at fold-2 epoch-54: mse-0.096041, rmse-0.309905, r2-0.843229
Valid at fold-2: mse-0.170701
Traing Log at fold-2 epoch-55: mse-0.093491, rmse-0.305764, r2-0.848413
Valid at fold-2: mse-0.172227
Traing Log at fold-2 epoch-56: mse-0.091544, rmse-0.302562, r2-0.851616
Valid at fold-2: mse-0.182626
Traing Log at fold-2 epoch-57: mse-0.089534, rmse-0.299223, r2-0.855603
Valid at fold-2: mse-0.177297
Traing Log at fold-2 epoch-58: mse-0.089412, rmse-0.299018, r2-0.85614
Valid at fold-2: mse-0.170171
Update best_mse, Valid at fold-2 epoch-58: mse-0.170171, rmse-0.412518, ci--1, r2-0.752792, pearson-0.873275, spearman-0.849851
Traing Log at fold-2 epoch-59: mse-0.0885, rmse-0.29749, r2-0.8574
Valid at fold-2: mse-0.164737
Update best_mse, Valid at fold-2 epoch-59: mse-0.164737, rmse-0.405878, ci--1, r2-0.760686, pearson-0.876541, spearman-0.852253
Traing Log at fold-2 epoch-60: mse-0.086897, rmse-0.294784, r2-0.860243
Valid at fold-2: mse-0.183921
Traing Log at fold-2 epoch-61: mse-0.085773, rmse-0.29287, r2-0.862549
Valid at fold-2: mse-0.166127
Traing Log at fold-2 epoch-62: mse-0.083746, rmse-0.289388, r2-0.865882
Valid at fold-2: mse-0.171065
Traing Log at fold-2 epoch-63: mse-0.083169, rmse-0.28839, r2-0.867275
Valid at fold-2: mse-0.170018
Traing Log at fold-2 epoch-64: mse-0.081373, rmse-0.285259, r2-0.870486
Valid at fold-2: mse-0.164308
Update best_mse, Valid at fold-2 epoch-64: mse-0.164308, rmse-0.40535, ci--1, r2-0.761309, pearson-0.876502, spearman-0.855669
Traing Log at fold-2 epoch-65: mse-0.08059, rmse-0.283883, r2-0.87186
Valid at fold-2: mse-0.167046
Traing Log at fold-2 epoch-66: mse-0.079694, rmse-0.282301, r2-0.873327
Valid at fold-2: mse-0.176958
Traing Log at fold-2 epoch-67: mse-0.079098, rmse-0.281243, r2-0.874423
Valid at fold-2: mse-0.164164
Update best_mse, Valid at fold-2 epoch-67: mse-0.164164, rmse-0.405172, ci--1, r2-0.761518, pearson-0.876344, spearman-0.853308
Traing Log at fold-2 epoch-68: mse-0.077696, rmse-0.27874, r2-0.876876
Valid at fold-2: mse-0.162743
Update best_mse, Valid at fold-2 epoch-68: mse-0.162743, rmse-0.403415, ci--1, r2-0.763582, pearson-0.87745, spearman-0.855534
Traing Log at fold-2 epoch-69: mse-0.077186, rmse-0.277824, r2-0.87806
Valid at fold-2: mse-0.169603
Traing Log at fold-2 epoch-70: mse-0.07567, rmse-0.275082, r2-0.880386
Valid at fold-2: mse-0.167084
Traing Log at fold-2 epoch-71: mse-0.07434, rmse-0.272653, r2-0.882982
Valid at fold-2: mse-0.167022
Traing Log at fold-2 epoch-72: mse-0.073242, rmse-0.270633, r2-0.884946
Valid at fold-2: mse-0.165091
Traing Log at fold-2 epoch-73: mse-0.071742, rmse-0.267847, r2-0.887285
Valid at fold-2: mse-0.170327
Traing Log at fold-2 epoch-74: mse-0.071497, rmse-0.26739, r2-0.887778
Valid at fold-2: mse-0.164474
Traing Log at fold-2 epoch-75: mse-0.069662, rmse-0.263935, r2-0.891068
Valid at fold-2: mse-0.169012
Traing Log at fold-2 epoch-76: mse-0.070229, rmse-0.265007, r2-0.889981
Valid at fold-2: mse-0.160642
Update best_mse, Valid at fold-2 epoch-76: mse-0.160642, rmse-0.400802, ci--1, r2-0.766635, pearson-0.881508, spearman-0.858489
Traing Log at fold-2 epoch-77: mse-0.067755, rmse-0.260298, r2-0.894287
Valid at fold-2: mse-0.169388
Traing Log at fold-2 epoch-78: mse-0.067548, rmse-0.259899, r2-0.894663
Valid at fold-2: mse-0.162108
Traing Log at fold-2 epoch-79: mse-0.067025, rmse-0.258893, r2-0.895571
Valid at fold-2: mse-0.164674
Traing Log at fold-2 epoch-80: mse-0.065576, rmse-0.256077, r2-0.898058
Valid at fold-2: mse-0.167813
Traing Log at fold-2 epoch-81: mse-0.064708, rmse-0.254378, r2-0.899668
Valid at fold-2: mse-0.167306
Traing Log at fold-2 epoch-82: mse-0.064772, rmse-0.254503, r2-0.899321
Valid at fold-2: mse-0.160077
Update best_mse, Valid at fold-2 epoch-82: mse-0.160077, rmse-0.400097, ci--1, r2-0.767455, pearson-0.878383, spearman-0.8569
Traing Log at fold-2 epoch-83: mse-0.062853, rmse-0.250705, r2-0.902699
Valid at fold-2: mse-0.166465
Traing Log at fold-2 epoch-84: mse-0.062835, rmse-0.25067, r2-0.902727
Valid at fold-2: mse-0.161835
Traing Log at fold-2 epoch-85: mse-0.062128, rmse-0.249254, r2-0.903887
Valid at fold-2: mse-0.164589
Traing Log at fold-2 epoch-86: mse-0.061555, rmse-0.248103, r2-0.90485
Valid at fold-2: mse-0.166007
Traing Log at fold-2 epoch-87: mse-0.059052, rmse-0.243007, r2-0.909088
Valid at fold-2: mse-0.161702
Traing Log at fold-2 epoch-88: mse-0.059395, rmse-0.243711, r2-0.908536
Valid at fold-2: mse-0.159628
Update best_mse, Valid at fold-2 epoch-88: mse-0.159628, rmse-0.399534, ci--1, r2-0.768109, pearson-0.881947, spearman-0.86073
Traing Log at fold-2 epoch-89: mse-0.058352, rmse-0.241561, r2-0.910223
Valid at fold-2: mse-0.161313
Traing Log at fold-2 epoch-90: mse-0.058046, rmse-0.240928, r2-0.910704
Valid at fold-2: mse-0.171655
Traing Log at fold-2 epoch-91: mse-0.05672, rmse-0.238161, r2-0.913062
Valid at fold-2: mse-0.161817
Traing Log at fold-2 epoch-92: mse-0.05593, rmse-0.236496, r2-0.914151
Valid at fold-2: mse-0.163497
Traing Log at fold-2 epoch-93: mse-0.055572, rmse-0.235738, r2-0.914945
Valid at fold-2: mse-0.166448
Traing Log at fold-2 epoch-94: mse-0.054639, rmse-0.23375, r2-0.916527
Valid at fold-2: mse-0.160919
Traing Log at fold-2 epoch-95: mse-0.054127, rmse-0.232653, r2-0.917283
Valid at fold-2: mse-0.161574
Traing Log at fold-2 epoch-96: mse-0.054114, rmse-0.232623, r2-0.917411
Valid at fold-2: mse-0.159364
Update best_mse, Valid at fold-2 epoch-96: mse-0.159364, rmse-0.399205, ci--1, r2-0.768491, pearson-0.881311, spearman-0.862001
Traing Log at fold-2 epoch-97: mse-0.053364, rmse-0.231006, r2-0.918469
Valid at fold-2: mse-0.15806
Update best_mse, Valid at fold-2 epoch-97: mse-0.15806, rmse-0.397567, ci--1, r2-0.770386, pearson-0.881017, spearman-0.864213
Traing Log at fold-2 epoch-98: mse-0.052002, rmse-0.228039, r2-0.920776
Valid at fold-2: mse-0.16133
Traing Log at fold-2 epoch-99: mse-0.051314, rmse-0.226526, r2-0.921884
Valid at fold-2: mse-0.155267
Update best_mse, Valid at fold-2 epoch-99: mse-0.155267, rmse-0.394039, ci--1, r2-0.774443, pearson-0.883634, spearman-0.862138
Traing Log at fold-2 epoch-100: mse-0.050518, rmse-0.224762, r2-0.923129
Valid at fold-2: mse-0.169212
Traing Log at fold-2 epoch-101: mse-0.049708, rmse-0.222953, r2-0.924555
Valid at fold-2: mse-0.162045
Traing Log at fold-2 epoch-102: mse-0.049688, rmse-0.222907, r2-0.924521
Valid at fold-2: mse-0.164695
Traing Log at fold-2 epoch-103: mse-0.049004, rmse-0.221368, r2-0.92566
Valid at fold-2: mse-0.162591
Traing Log at fold-2 epoch-104: mse-0.048457, rmse-0.22013, r2-0.926472
Valid at fold-2: mse-0.158197
Traing Log at fold-2 epoch-105: mse-0.047588, rmse-0.218148, r2-0.927983
Valid at fold-2: mse-0.156469
Traing Log at fold-2 epoch-106: mse-0.047399, rmse-0.217714, r2-0.928241
Valid at fold-2: mse-0.160707
Traing Log at fold-2 epoch-107: mse-0.046802, rmse-0.216338, r2-0.929228
Valid at fold-2: mse-0.159601
Traing Log at fold-2 epoch-108: mse-0.045875, rmse-0.214184, r2-0.930767
Valid at fold-2: mse-0.162271
Traing Log at fold-2 epoch-109: mse-0.045406, rmse-0.213086, r2-0.931429
Valid at fold-2: mse-0.157778
Traing Log at fold-2 epoch-110: mse-0.044834, rmse-0.21174, r2-0.932474
Valid at fold-2: mse-0.154276
Update best_mse, Valid at fold-2 epoch-110: mse-0.154276, rmse-0.39278, ci--1, r2-0.775883, pearson-0.883162, spearman-0.865527
Traing Log at fold-2 epoch-111: mse-0.045302, rmse-0.212842, r2-0.931665
Valid at fold-2: mse-0.15851
Traing Log at fold-2 epoch-112: mse-0.04417, rmse-0.210166, r2-0.933492
Valid at fold-2: mse-0.154132
Update best_mse, Valid at fold-2 epoch-112: mse-0.154132, rmse-0.392597, ci--1, r2-0.776092, pearson-0.884754, spearman-0.86642
Traing Log at fold-2 epoch-113: mse-0.043796, rmse-0.209276, r2-0.934056
Valid at fold-2: mse-0.15597
Traing Log at fold-2 epoch-114: mse-0.0435, rmse-0.208567, r2-0.934542
Valid at fold-2: mse-0.155709
Traing Log at fold-2 epoch-115: mse-0.042755, rmse-0.206772, r2-0.9357
Valid at fold-2: mse-0.170812
Traing Log at fold-2 epoch-116: mse-0.04209, rmse-0.205158, r2-0.936719
Valid at fold-2: mse-0.160201
Traing Log at fold-2 epoch-117: mse-0.042121, rmse-0.205234, r2-0.936807
Valid at fold-2: mse-0.167877
Traing Log at fold-2 epoch-118: mse-0.041526, rmse-0.20378, r2-0.937735
Valid at fold-2: mse-0.154666
Traing Log at fold-2 epoch-119: mse-0.040994, rmse-0.202469, r2-0.938545
Valid at fold-2: mse-0.160714
Traing Log at fold-2 epoch-120: mse-0.040169, rmse-0.200423, r2-0.939788
Valid at fold-2: mse-0.163993
Traing Log at fold-2 epoch-121: mse-0.039902, rmse-0.199756, r2-0.940271
Valid at fold-2: mse-0.163258
Traing Log at fold-2 epoch-122: mse-0.039578, rmse-0.198943, r2-0.940763
Valid at fold-2: mse-0.160092
Traing Log at fold-2 epoch-123: mse-0.039273, rmse-0.198174, r2-0.941279
Valid at fold-2: mse-0.16126
Traing Log at fold-2 epoch-124: mse-0.038579, rmse-0.196415, r2-0.942373
Valid at fold-2: mse-0.152776
Update best_mse, Valid at fold-2 epoch-124: mse-0.152776, rmse-0.390866, ci--1, r2-0.778062, pearson-0.885021, spearman-0.866478
Traing Log at fold-2 epoch-125: mse-0.038354, rmse-0.195842, r2-0.942731
Valid at fold-2: mse-0.167878
Traing Log at fold-2 epoch-126: mse-0.037543, rmse-0.19376, r2-0.943953
Valid at fold-2: mse-0.155945
Traing Log at fold-2 epoch-127: mse-0.037626, rmse-0.193975, r2-0.94385
Valid at fold-2: mse-0.158883
Traing Log at fold-2 epoch-128: mse-0.03748, rmse-0.193598, r2-0.944128
Valid at fold-2: mse-0.152948
Traing Log at fold-2 epoch-129: mse-0.036836, rmse-0.191928, r2-0.945067
Valid at fold-2: mse-0.156938
Traing Log at fold-2 epoch-130: mse-0.036496, rmse-0.191038, r2-0.945626
Valid at fold-2: mse-0.152385
Update best_mse, Valid at fold-2 epoch-130: mse-0.152385, rmse-0.390365, ci--1, r2-0.77863, pearson-0.884064, spearman-0.865774
Traing Log at fold-2 epoch-131: mse-0.036169, rmse-0.190181, r2-0.946119
Valid at fold-2: mse-0.156333
Traing Log at fold-2 epoch-132: mse-0.035226, rmse-0.187687, r2-0.947555
Valid at fold-2: mse-0.158347
Traing Log at fold-2 epoch-133: mse-0.035512, rmse-0.188445, r2-0.947196
Valid at fold-2: mse-0.157543
Traing Log at fold-2 epoch-134: mse-0.035346, rmse-0.188006, r2-0.947416
Valid at fold-2: mse-0.155956
Traing Log at fold-2 epoch-135: mse-0.034698, rmse-0.186275, r2-0.948408
Valid at fold-2: mse-0.155854
Traing Log at fold-2 epoch-136: mse-0.034181, rmse-0.184882, r2-0.949249
Valid at fold-2: mse-0.159547
Traing Log at fold-2 epoch-137: mse-0.034262, rmse-0.185099, r2-0.949097
Valid at fold-2: mse-0.156669
Traing Log at fold-2 epoch-138: mse-0.033692, rmse-0.183553, r2-0.949987
Valid at fold-2: mse-0.157411
Traing Log at fold-2 epoch-139: mse-0.034076, rmse-0.184598, r2-0.949526
Valid at fold-2: mse-0.15196
Update best_mse, Valid at fold-2 epoch-139: mse-0.15196, rmse-0.389821, ci--1, r2-0.779247, pearson-0.885924, spearman-0.869932
Traing Log at fold-2 epoch-140: mse-0.033338, rmse-0.182587, r2-0.950566
Valid at fold-2: mse-0.151909
Update best_mse, Valid at fold-2 epoch-140: mse-0.151909, rmse-0.389755, ci--1, r2-0.779321, pearson-0.884917, spearman-0.867637
Traing Log at fold-2 epoch-141: mse-0.03287, rmse-0.181302, r2-0.951298
Valid at fold-2: mse-0.15222
Traing Log at fold-2 epoch-142: mse-0.0331, rmse-0.181935, r2-0.950873
Valid at fold-2: mse-0.154139
Traing Log at fold-2 epoch-143: mse-0.032539, rmse-0.180384, r2-0.951816
Valid at fold-2: mse-0.152563
Traing Log at fold-2 epoch-144: mse-0.032492, rmse-0.180255, r2-0.951873
Valid at fold-2: mse-0.158055
Traing Log at fold-2 epoch-145: mse-0.03205, rmse-0.179025, r2-0.952606
Valid at fold-2: mse-0.153504
Traing Log at fold-2 epoch-146: mse-0.032361, rmse-0.179892, r2-0.951994
Valid at fold-2: mse-0.158324
Traing Log at fold-2 epoch-147: mse-0.031074, rmse-0.176279, r2-0.954143
Valid at fold-2: mse-0.152012
Traing Log at fold-2 epoch-148: mse-0.031727, rmse-0.17812, r2-0.953051
Valid at fold-2: mse-0.156314
Traing Log at fold-2 epoch-149: mse-0.031306, rmse-0.176936, r2-0.953754
Valid at fold-2: mse-0.155381
Traing Log at fold-2 epoch-150: mse-0.030814, rmse-0.175538, r2-0.954444
Valid at fold-2: mse-0.154466
Traing Log at fold-2 epoch-151: mse-0.031207, rmse-0.176654, r2-0.953869
Valid at fold-2: mse-0.157766
Traing Log at fold-2 epoch-152: mse-0.030234, rmse-0.173879, r2-0.955362
Valid at fold-2: mse-0.160135
Traing Log at fold-2 epoch-153: mse-0.030115, rmse-0.173536, r2-0.955547
Valid at fold-2: mse-0.156832
Traing Log at fold-2 epoch-154: mse-0.030244, rmse-0.173909, r2-0.955312
Valid at fold-2: mse-0.160891
Traing Log at fold-2 epoch-155: mse-0.029279, rmse-0.17111, r2-0.956855
Valid at fold-2: mse-0.156465
Traing Log at fold-2 epoch-156: mse-0.029329, rmse-0.171256, r2-0.956748
Valid at fold-2: mse-0.152997
Traing Log at fold-2 epoch-157: mse-0.028896, rmse-0.169988, r2-0.957371
Valid at fold-2: mse-0.153471
Traing Log at fold-2 epoch-158: mse-0.029274, rmse-0.171097, r2-0.956862
Valid at fold-2: mse-0.152282
Traing Log at fold-2 epoch-159: mse-0.028126, rmse-0.167707, r2-0.958546
Valid at fold-2: mse-0.154913
Traing Log at fold-2 epoch-160: mse-0.028864, rmse-0.169893, r2-0.957431
Valid at fold-2: mse-0.160811
Traing Log at fold-2 epoch-161: mse-0.028124, rmse-0.167702, r2-0.958623
Valid at fold-2: mse-0.15103
Update best_mse, Valid at fold-2 epoch-161: mse-0.15103, rmse-0.388625, ci--1, r2-0.780599, pearson-0.887778, spearman-0.870852
Traing Log at fold-2 epoch-162: mse-0.028008, rmse-0.167357, r2-0.958747
Valid at fold-2: mse-0.155332
Traing Log at fold-2 epoch-163: mse-0.028285, rmse-0.168182, r2-0.958349
Valid at fold-2: mse-0.155991
Traing Log at fold-2 epoch-164: mse-0.027694, rmse-0.166415, r2-0.95926
Valid at fold-2: mse-0.154893
Traing Log at fold-2 epoch-165: mse-0.027417, rmse-0.165581, r2-0.959651
Valid at fold-2: mse-0.149525
Update best_mse, Valid at fold-2 epoch-165: mse-0.149525, rmse-0.386685, ci--1, r2-0.782784, pearson-0.886968, spearman-0.870113
Traing Log at fold-2 epoch-166: mse-0.027269, rmse-0.165135, r2-0.959887
Valid at fold-2: mse-0.152266
Traing Log at fold-2 epoch-167: mse-0.027739, rmse-0.166549, r2-0.959194
Valid at fold-2: mse-0.150133
Traing Log at fold-2 epoch-168: mse-0.027536, rmse-0.165941, r2-0.959455
Valid at fold-2: mse-0.161996
Traing Log at fold-2 epoch-169: mse-0.026721, rmse-0.163465, r2-0.960776
Valid at fold-2: mse-0.155583
Traing Log at fold-2 epoch-170: mse-0.026986, rmse-0.164273, r2-0.960358
Valid at fold-2: mse-0.151131
Traing Log at fold-2 epoch-171: mse-0.026741, rmse-0.163527, r2-0.960611
Valid at fold-2: mse-0.15527
Traing Log at fold-2 epoch-172: mse-0.026494, rmse-0.16277, r2-0.961101
Valid at fold-2: mse-0.151794
Traing Log at fold-2 epoch-173: mse-0.026104, rmse-0.161566, r2-0.96168
Valid at fold-2: mse-0.150249
Traing Log at fold-2 epoch-174: mse-0.026013, rmse-0.161287, r2-0.961814
Valid at fold-2: mse-0.150417
Traing Log at fold-2 epoch-175: mse-0.02573, rmse-0.160406, r2-0.962228
Valid at fold-2: mse-0.153197
Traing Log at fold-2 epoch-176: mse-0.025472, rmse-0.159601, r2-0.962621
Valid at fold-2: mse-0.152596
Traing Log at fold-2 epoch-177: mse-0.025878, rmse-0.160866, r2-0.962017
Valid at fold-2: mse-0.153432
Traing Log at fold-2 epoch-178: mse-0.025349, rmse-0.159213, r2-0.962824
Valid at fold-2: mse-0.152231
Traing Log at fold-2 epoch-179: mse-0.025238, rmse-0.158865, r2-0.962986
Valid at fold-2: mse-0.153268
Traing Log at fold-2 epoch-180: mse-0.025406, rmse-0.159392, r2-0.962751
Valid at fold-2: mse-0.152227
Traing Log at fold-2 epoch-181: mse-0.024519, rmse-0.156587, r2-0.964071
Valid at fold-2: mse-0.15247
Traing Log at fold-2 epoch-182: mse-0.024976, rmse-0.158039, r2-0.963303
Valid at fold-2: mse-0.15452
Traing Log at fold-2 epoch-183: mse-0.02467, rmse-0.157066, r2-0.963809
Valid at fold-2: mse-0.157909
Traing Log at fold-2 epoch-184: mse-0.024582, rmse-0.156786, r2-0.964002
Valid at fold-2: mse-0.15299
Traing Log at fold-2 epoch-185: mse-0.024581, rmse-0.156783, r2-0.963982
Valid at fold-2: mse-0.152624
Traing Log at fold-2 epoch-186: mse-0.024365, rmse-0.156094, r2-0.964304
Valid at fold-2: mse-0.154021
Traing stop at epoch-186, model save at-./savemodel/kiba-novel-drug-fold2-Nov13_07-15-02.pth
Save log over at ./log/Nov13_07-15-02-kiba-novel-drug-fold2.csv

============================================================
Testing fold 2 with best model...
============================================================
/home/minhtrin/.conda/envs/LLMDTA/lib/python3.10/site-packages/torch/nn/utils/weight_norm.py:144: FutureWarning: `torch.nn.utils.weight_norm` is deprecated in favor of `torch.nn.utils.parametrizations.weight_norm`.
  WeightNorm.apply(module, name, dim)
Test at fold-2, mse: 0.321502, rmse: 0.567011, ci: 0.782157, r2: 0.539645, pearson: 0.742729, spearman: 0.699188

Fold 2 results saved to: ./log/Test-kiba-novel-drug-fold2-Nov13_07-15-02.csv
============================================================
Training fold 2 completed successfully!
============================================================
wandb: updating run metadata
wandb: uploading output.log; uploading wandb-summary.json
wandb: uploading config.yaml
wandb: 
wandb: Run history:
wandb:      best_valid/mse â–ˆâ–„â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb:  best_valid/pearson â–â–ƒâ–„â–…â–…â–…â–†â–†â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:       best_valid/r2 â–â–…â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:     best_valid/rmse â–ˆâ–…â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb: best_valid/spearman â–â–ƒâ–„â–…â–…â–…â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:               epoch â–â–â–â–â–â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆ
wandb:             test/ci â–
wandb:            test/mse â–
wandb:        test/pearson â–
wandb:             test/r2 â–
wandb:                 +13 ...
wandb: 
wandb: Run summary:
wandb:      best_valid/mse 0.14952
wandb:  best_valid/pearson 0.88697
wandb:       best_valid/r2 0.78278
wandb:     best_valid/rmse 0.38669
wandb: best_valid/spearman 0.87011
wandb:               epoch 186
wandb:       final_test_ci 0.78216
wandb:      final_test_mse 0.3215
wandb:  final_test_pearson 0.74273
wandb:       final_test_r2 0.53965
wandb:                 +19 ...
wandb: 
wandb: ğŸš€ View run kiba-novel-drug-fold2 at: https://wandb.ai/tringuyen/LLMDTA/runs/3hrz0atd
wandb: â­ï¸ View project at: https://wandb.ai/tringuyen/LLMDTA
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20251113_071503-3hrz0atd/logs
Weights & Biases run finished

Training for fold 2 completed successfully.
Python script exit code: 0
==========================================
End Time: Fri Nov 14 04:20:52 PM AEDT 2025
==========================================
